{"ast":null,"code":"/**\r\n * 权限管理工具\r\n * 根据用户类型检查权限\r\n */\n\n// System Admin 权限\nexport const SYSTEM_ADMIN_PERMISSIONS = {\n  // 用户管理\n  VIEW_ALL_USERS: 'view_all_users',\n  // #50\n  CREATE_USER: 'create_user',\n  // #70, #55\n  UPDATE_USER: 'update_user',\n  // #70\n  SUSPEND_USER: 'suspend_user',\n  // #52\n  DELETE_USER: 'delete_user',\n  // 系统监控\n  VIEW_SYSTEM_LOGS: 'view_system_logs',\n  // #51\n  VIEW_LOGIN_ACTIVITY: 'view_login_activity',\n  // #51\n  CONFIGURE_ALERTS: 'configure_alerts',\n  // 系统设置\n  SET_FILE_LIMITS: 'set_file_limits',\n  // #56\n  CONFIGURE_SYSTEM: 'configure_system'\n};\n\n// Platform Manager 权限\nexport const PLATFORM_MANAGER_PERMISSIONS = {\n  // 类别管理\n  MANAGE_CATEGORIES: 'manage_categories',\n  // #57\n  CREATE_CATEGORY: 'create_category',\n  // #57\n  EDIT_CATEGORY: 'edit_category',\n  // #57\n  DELETE_CATEGORY: 'delete_category',\n  // #57\n\n  // 报告和分析\n  GENERATE_REPORTS: 'generate_reports',\n  // #58\n  VIEW_PARTICIPATION_METRICS: 'view_participation_metrics',\n  // #59\n  VIEW_EFFICIENCY_METRICS: 'view_efficiency_metrics',\n  // #60\n  VIEW_CSR_PERFORMANCE: 'view_csr_performance',\n  // #62\n\n  // 统计数据\n  VIEW_SYSTEM_STATS: 'view_system_stats' // #60\n};\n\n// 共享权限（两种管理员都有）\nexport const SHARED_ADMIN_PERMISSIONS = {\n  VIEW_DASHBOARD: 'view_dashboard',\n  VIEW_BASIC_STATS: 'view_basic_stats'\n};\n\n/**\r\n * 检查用户是否有特定权限\r\n * @param {Object} user - 用户对象\r\n * @param {string} permission - 权限名称\r\n * @returns {boolean}\r\n */\nexport const hasPermission = (user, permission) => {\n  if (!user || !user.userType) return false;\n  const userType = user.userType;\n\n  // 检查共享权限\n  if (Object.values(SHARED_ADMIN_PERMISSIONS).includes(permission)) {\n    return userType === 'system_admin' || userType === 'platform_manager';\n  }\n\n  // 检查 System Admin 权限\n  if (Object.values(SYSTEM_ADMIN_PERMISSIONS).includes(permission)) {\n    return userType === 'system_admin';\n  }\n\n  // 检查 Platform Manager 权限\n  if (Object.values(PLATFORM_MANAGER_PERMISSIONS).includes(permission)) {\n    return userType === 'platform_manager';\n  }\n  return false;\n};\n\n/**\r\n * 检查用户是否是系统管理员\r\n */\nexport const isSystemAdmin = user => {\n  return (user === null || user === void 0 ? void 0 : user.userType) === 'system_admin';\n};\n\n/**\r\n * 检查用户是否是平台管理者\r\n */\nexport const isPlatformManager = user => {\n  return (user === null || user === void 0 ? void 0 : user.userType) === 'platform_manager';\n};\n\n/**\r\n * 检查用户是否是任意类型的管理员\r\n */\nexport const isAnyAdmin = user => {\n  return isSystemAdmin(user) || isPlatformManager(user);\n};\n\n/**\r\n * 获取用户的所有权限列表\r\n */\nexport const getUserPermissions = user => {\n  if (!user) return [];\n  const permissions = [...Object.values(SHARED_ADMIN_PERMISSIONS)];\n  if (isSystemAdmin(user)) {\n    permissions.push(...Object.values(SYSTEM_ADMIN_PERMISSIONS));\n  }\n  if (isPlatformManager(user)) {\n    permissions.push(...Object.values(PLATFORM_MANAGER_PERMISSIONS));\n  }\n  return permissions;\n};\n\n/**\r\n * 获取用户角色的显示名称\r\n */\nexport const getRoleDisplayName = (userType, t) => {\n  const roleNames = {\n    system_admin: t ? t('roles.systemAdmin') : 'System Admin',\n    platform_manager: t ? t('roles.platformManager') : 'Platform Manager',\n    pin: t ? t('roles.pin.name') : 'PIN',\n    csr: t ? t('roles.csr.name') : 'CSR'\n  };\n  return roleNames[userType] || userType;\n};","map":{"version":3,"names":["SYSTEM_ADMIN_PERMISSIONS","VIEW_ALL_USERS","CREATE_USER","UPDATE_USER","SUSPEND_USER","DELETE_USER","VIEW_SYSTEM_LOGS","VIEW_LOGIN_ACTIVITY","CONFIGURE_ALERTS","SET_FILE_LIMITS","CONFIGURE_SYSTEM","PLATFORM_MANAGER_PERMISSIONS","MANAGE_CATEGORIES","CREATE_CATEGORY","EDIT_CATEGORY","DELETE_CATEGORY","GENERATE_REPORTS","VIEW_PARTICIPATION_METRICS","VIEW_EFFICIENCY_METRICS","VIEW_CSR_PERFORMANCE","VIEW_SYSTEM_STATS","SHARED_ADMIN_PERMISSIONS","VIEW_DASHBOARD","VIEW_BASIC_STATS","hasPermission","user","permission","userType","Object","values","includes","isSystemAdmin","isPlatformManager","isAnyAdmin","getUserPermissions","permissions","push","getRoleDisplayName","t","roleNames","system_admin","platform_manager","pin","csr"],"sources":["D:/Study/CSIT314-GP/src/utils/permissions.js"],"sourcesContent":["/**\r\n * 权限管理工具\r\n * 根据用户类型检查权限\r\n */\r\n\r\n// System Admin 权限\r\nexport const SYSTEM_ADMIN_PERMISSIONS = {\r\n  // 用户管理\r\n  VIEW_ALL_USERS: 'view_all_users', // #50\r\n  CREATE_USER: 'create_user', // #70, #55\r\n  UPDATE_USER: 'update_user', // #70\r\n  SUSPEND_USER: 'suspend_user', // #52\r\n  DELETE_USER: 'delete_user',\r\n  \r\n  // 系统监控\r\n  VIEW_SYSTEM_LOGS: 'view_system_logs', // #51\r\n  VIEW_LOGIN_ACTIVITY: 'view_login_activity', // #51\r\n  CONFIGURE_ALERTS: 'configure_alerts',\r\n  \r\n  // 系统设置\r\n  SET_FILE_LIMITS: 'set_file_limits', // #56\r\n  CONFIGURE_SYSTEM: 'configure_system',\r\n};\r\n\r\n// Platform Manager 权限\r\nexport const PLATFORM_MANAGER_PERMISSIONS = {\r\n  // 类别管理\r\n  MANAGE_CATEGORIES: 'manage_categories', // #57\r\n  CREATE_CATEGORY: 'create_category', // #57\r\n  EDIT_CATEGORY: 'edit_category', // #57\r\n  DELETE_CATEGORY: 'delete_category', // #57\r\n  \r\n  // 报告和分析\r\n  GENERATE_REPORTS: 'generate_reports', // #58\r\n  VIEW_PARTICIPATION_METRICS: 'view_participation_metrics', // #59\r\n  VIEW_EFFICIENCY_METRICS: 'view_efficiency_metrics', // #60\r\n  VIEW_CSR_PERFORMANCE: 'view_csr_performance', // #62\r\n  \r\n  // 统计数据\r\n  VIEW_SYSTEM_STATS: 'view_system_stats', // #60\r\n};\r\n\r\n// 共享权限（两种管理员都有）\r\nexport const SHARED_ADMIN_PERMISSIONS = {\r\n  VIEW_DASHBOARD: 'view_dashboard',\r\n  VIEW_BASIC_STATS: 'view_basic_stats',\r\n};\r\n\r\n/**\r\n * 检查用户是否有特定权限\r\n * @param {Object} user - 用户对象\r\n * @param {string} permission - 权限名称\r\n * @returns {boolean}\r\n */\r\nexport const hasPermission = (user, permission) => {\r\n  if (!user || !user.userType) return false;\r\n  \r\n  const userType = user.userType;\r\n  \r\n  // 检查共享权限\r\n  if (Object.values(SHARED_ADMIN_PERMISSIONS).includes(permission)) {\r\n    return userType === 'system_admin' || userType === 'platform_manager';\r\n  }\r\n  \r\n  // 检查 System Admin 权限\r\n  if (Object.values(SYSTEM_ADMIN_PERMISSIONS).includes(permission)) {\r\n    return userType === 'system_admin';\r\n  }\r\n  \r\n  // 检查 Platform Manager 权限\r\n  if (Object.values(PLATFORM_MANAGER_PERMISSIONS).includes(permission)) {\r\n    return userType === 'platform_manager';\r\n  }\r\n  \r\n  return false;\r\n};\r\n\r\n/**\r\n * 检查用户是否是系统管理员\r\n */\r\nexport const isSystemAdmin = (user) => {\r\n  return user?.userType === 'system_admin';\r\n};\r\n\r\n/**\r\n * 检查用户是否是平台管理者\r\n */\r\nexport const isPlatformManager = (user) => {\r\n  return user?.userType === 'platform_manager';\r\n};\r\n\r\n/**\r\n * 检查用户是否是任意类型的管理员\r\n */\r\nexport const isAnyAdmin = (user) => {\r\n  return isSystemAdmin(user) || isPlatformManager(user);\r\n};\r\n\r\n/**\r\n * 获取用户的所有权限列表\r\n */\r\nexport const getUserPermissions = (user) => {\r\n  if (!user) return [];\r\n  \r\n  const permissions = [...Object.values(SHARED_ADMIN_PERMISSIONS)];\r\n  \r\n  if (isSystemAdmin(user)) {\r\n    permissions.push(...Object.values(SYSTEM_ADMIN_PERMISSIONS));\r\n  }\r\n  \r\n  if (isPlatformManager(user)) {\r\n    permissions.push(...Object.values(PLATFORM_MANAGER_PERMISSIONS));\r\n  }\r\n  \r\n  return permissions;\r\n};\r\n\r\n/**\r\n * 获取用户角色的显示名称\r\n */\r\nexport const getRoleDisplayName = (userType, t) => {\r\n  const roleNames = {\r\n    system_admin: t ? t('roles.systemAdmin') : 'System Admin',\r\n    platform_manager: t ? t('roles.platformManager') : 'Platform Manager',\r\n    pin: t ? t('roles.pin.name') : 'PIN',\r\n    csr: t ? t('roles.csr.name') : 'CSR'\r\n  };\r\n  \r\n  return roleNames[userType] || userType;\r\n};\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}