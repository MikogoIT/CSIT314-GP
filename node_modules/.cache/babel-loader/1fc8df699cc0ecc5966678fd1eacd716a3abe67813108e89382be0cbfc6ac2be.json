{"ast":null,"code":"// 真实数据报告服务\n// src/services/reportService.js\n\nimport { DataService } from './dataService';\nexport class ReportService {\n  // 获取指定日期范围的数据\n  static getDateRangeData(startDate, endDate, requests, users) {\n    const start = new Date(startDate);\n    const end = new Date(endDate);\n    const filteredRequests = requests.filter(request => {\n      const date = new Date(request.createdAt);\n      return date >= start && date <= end;\n    });\n    const filteredUsers = users.filter(user => {\n      const date = new Date(user.registeredAt || user.createdAt);\n      return date >= start && date <= end;\n    });\n    return {\n      requests: filteredRequests,\n      users: filteredUsers\n    };\n  }\n\n  // 生成日报数据\n  static generateDailyReport(targetDate = new Date()) {\n    const users = DataService.getUsers();\n    const requests = DataService.getRequests();\n    const today = new Date(targetDate);\n    today.setHours(0, 0, 0, 0);\n    const tomorrow = new Date(today);\n    tomorrow.setDate(tomorrow.getDate() + 1);\n    const {\n      requests: todayRequests,\n      users: todayUsers\n    } = this.getDateRangeData(today.toISOString(), tomorrow.toISOString(), requests, users);\n\n    // 计算昨天的数据用于对比\n    const yesterday = new Date(today);\n    yesterday.setDate(yesterday.getDate() - 1);\n    const {\n      requests: yesterdayRequests,\n      users: yesterdayUsers\n    } = this.getDateRangeData(yesterday.toISOString(), today.toISOString(), requests, users);\n    const todayMatched = todayRequests.filter(r => r.status === 'matched').length;\n    const yesterdayMatched = yesterdayRequests.filter(r => r.status === 'matched').length;\n    const matchGrowth = yesterdayMatched === 0 ? todayMatched > 0 ? 100 : 0 : Math.round((todayMatched - yesterdayMatched) / yesterdayMatched * 100);\n    const userGrowth = yesterdayUsers.length === 0 ? todayUsers.length > 0 ? 100 : 0 : Math.round((todayUsers.length - yesterdayUsers.length) / yesterdayUsers.length * 100);\n    const activeRequests = requests.filter(r => r.status === 'pending' || r.status === 'matched').length;\n\n    // 计算完成率\n    const completedToday = todayRequests.filter(r => r.status === 'completed').length;\n    const totalProcessedToday = todayRequests.filter(r => r.status !== 'pending').length;\n    const completionRate = totalProcessedToday === 0 ? 0 : Math.round(completedToday / totalProcessedToday * 100);\n    return {\n      reportType: 'daily',\n      date: today.toISOString().split('T')[0],\n      totalMatches: todayMatched,\n      newUsers: todayUsers.length,\n      activeRequests: activeRequests,\n      completionRate: `${completionRate}%`,\n      trends: {\n        matchGrowth: matchGrowth,\n        userGrowth: userGrowth,\n        completionRateChange: 0\n      },\n      details: {\n        categoryBreakdown: this.getCategoryBreakdown(todayRequests),\n        hourlyActivity: this.getHourlyActivity(todayRequests),\n        userTypeBreakdown: this.getUserTypeBreakdown(todayUsers)\n      }\n    };\n  }\n\n  // 生成周报数据\n  static generateWeeklyReport(targetDate = new Date()) {\n    const users = DataService.getUsers();\n    const requests = DataService.getRequests();\n    const endDate = new Date(targetDate);\n    const startDate = new Date(endDate);\n    startDate.setDate(startDate.getDate() - 7);\n    const {\n      requests: weekRequests,\n      users: weekUsers\n    } = this.getDateRangeData(startDate.toISOString(), endDate.toISOString(), requests, users);\n\n    // 计算上周数据用于对比\n    const lastWeekEnd = new Date(startDate);\n    const lastWeekStart = new Date(lastWeekEnd);\n    lastWeekStart.setDate(lastWeekStart.getDate() - 7);\n    const {\n      requests: lastWeekRequests,\n      users: lastWeekUsers\n    } = this.getDateRangeData(lastWeekStart.toISOString(), lastWeekEnd.toISOString(), requests, users);\n    const weekMatched = weekRequests.filter(r => r.status === 'matched').length;\n    const lastWeekMatched = lastWeekRequests.filter(r => r.status === 'matched').length;\n    const matchGrowth = lastWeekMatched === 0 ? weekMatched > 0 ? 100 : 0 : Math.round((weekMatched - lastWeekMatched) / lastWeekMatched * 100);\n    const userGrowth = lastWeekUsers.length === 0 ? weekUsers.length > 0 ? 100 : 0 : Math.round((weekUsers.length - lastWeekUsers.length) / lastWeekUsers.length * 100);\n    const activeRequests = requests.filter(r => r.status === 'pending' || r.status === 'matched').length;\n\n    // 计算完成率\n    const completedWeek = weekRequests.filter(r => r.status === 'completed').length;\n    const totalProcessedWeek = weekRequests.filter(r => r.status !== 'pending').length;\n    const completionRate = totalProcessedWeek === 0 ? 0 : Math.round(completedWeek / totalProcessedWeek * 100);\n    return {\n      reportType: 'weekly',\n      dateRange: `${startDate.toISOString().split('T')[0]} - ${endDate.toISOString().split('T')[0]}`,\n      totalMatches: weekMatched,\n      newUsers: weekUsers.length,\n      activeRequests: activeRequests,\n      completionRate: `${completionRate}%`,\n      trends: {\n        matchGrowth: matchGrowth,\n        userGrowth: userGrowth,\n        completionRateChange: 0\n      },\n      details: {\n        categoryBreakdown: this.getCategoryBreakdown(weekRequests),\n        dailyActivity: this.getDailyActivity(weekRequests, startDate, endDate),\n        userTypeBreakdown: this.getUserTypeBreakdown(weekUsers)\n      }\n    };\n  }\n\n  // 生成月报数据\n  static generateMonthlyReport(targetDate = new Date()) {\n    const users = DataService.getUsers();\n    const requests = DataService.getRequests();\n    const endDate = new Date(targetDate);\n    const startDate = new Date(endDate.getFullYear(), endDate.getMonth(), 1);\n    const {\n      requests: monthRequests,\n      users: monthUsers\n    } = this.getDateRangeData(startDate.toISOString(), endDate.toISOString(), requests, users);\n\n    // 计算上月数据用于对比\n    const lastMonthEnd = new Date(startDate);\n    lastMonthEnd.setDate(lastMonthEnd.getDate() - 1);\n    const lastMonthStart = new Date(lastMonthEnd.getFullYear(), lastMonthEnd.getMonth(), 1);\n    const {\n      requests: lastMonthRequests,\n      users: lastMonthUsers\n    } = this.getDateRangeData(lastMonthStart.toISOString(), lastMonthEnd.toISOString(), requests, users);\n    const monthMatched = monthRequests.filter(r => r.status === 'matched').length;\n    const lastMonthMatched = lastMonthRequests.filter(r => r.status === 'matched').length;\n    const matchGrowth = lastMonthMatched === 0 ? monthMatched > 0 ? 100 : 0 : Math.round((monthMatched - lastMonthMatched) / lastMonthMatched * 100);\n    const userGrowth = lastMonthUsers.length === 0 ? monthUsers.length > 0 ? 100 : 0 : Math.round((monthUsers.length - lastMonthUsers.length) / lastMonthUsers.length * 100);\n    const activeRequests = requests.filter(r => r.status === 'pending' || r.status === 'matched').length;\n\n    // 计算完成率\n    const completedMonth = monthRequests.filter(r => r.status === 'completed').length;\n    const totalProcessedMonth = monthRequests.filter(r => r.status !== 'pending').length;\n    const completionRate = totalProcessedMonth === 0 ? 0 : Math.round(completedMonth / totalProcessedMonth * 100);\n    return {\n      reportType: 'monthly',\n      dateRange: `${startDate.toISOString().split('T')[0]} - ${endDate.toISOString().split('T')[0]}`,\n      totalMatches: monthMatched,\n      newUsers: monthUsers.length,\n      activeRequests: activeRequests,\n      completionRate: `${completionRate}%`,\n      trends: {\n        matchGrowth: matchGrowth,\n        userGrowth: userGrowth,\n        completionRateChange: 0\n      },\n      details: {\n        categoryBreakdown: this.getCategoryBreakdown(monthRequests),\n        weeklyActivity: this.getWeeklyActivity(monthRequests, startDate, endDate),\n        userTypeBreakdown: this.getUserTypeBreakdown(monthUsers),\n        topPerformers: this.getTopPerformers(monthRequests)\n      }\n    };\n  }\n\n  // 获取分类统计\n  static getCategoryBreakdown(requests) {\n    const categories = DataService.getCategories();\n    const breakdown = {};\n    categories.forEach(category => {\n      breakdown[category.id] = {\n        name: category.name,\n        count: requests.filter(r => r.category === category.id).length,\n        matched: requests.filter(r => r.category === category.id && r.status === 'matched').length\n      };\n    });\n    return breakdown;\n  }\n\n  // 获取用户类型统计\n  static getUserTypeBreakdown(users) {\n    return {\n      pin: users.filter(u => u.userType === 'pin').length,\n      csr: users.filter(u => u.userType === 'csr').length,\n      admin: users.filter(u => u.userType === 'admin').length\n    };\n  }\n\n  // 获取每小时活动数据\n  static getHourlyActivity(requests) {\n    const hourlyData = Array.from({\n      length: 24\n    }, (_, i) => ({\n      hour: i,\n      count: 0\n    }));\n    requests.forEach(request => {\n      const hour = new Date(request.createdAt).getHours();\n      hourlyData[hour].count++;\n    });\n    return hourlyData;\n  }\n\n  // 获取每日活动数据\n  static getDailyActivity(requests, startDate, endDate) {\n    const dailyData = [];\n    const current = new Date(startDate);\n    while (current <= endDate) {\n      const dayStart = new Date(current);\n      dayStart.setHours(0, 0, 0, 0);\n      const dayEnd = new Date(current);\n      dayEnd.setHours(23, 59, 59, 999);\n      const dayRequests = requests.filter(request => {\n        const requestDate = new Date(request.createdAt);\n        return requestDate >= dayStart && requestDate <= dayEnd;\n      });\n      dailyData.push({\n        date: current.toISOString().split('T')[0],\n        count: dayRequests.length,\n        matched: dayRequests.filter(r => r.status === 'matched').length\n      });\n      current.setDate(current.getDate() + 1);\n    }\n    return dailyData;\n  }\n\n  // 获取每周活动数据  \n  static getWeeklyActivity(requests, startDate, endDate) {\n    const weeklyData = [];\n    const current = new Date(startDate);\n    while (current <= endDate) {\n      const weekStart = new Date(current);\n      const weekEnd = new Date(current);\n      weekEnd.setDate(weekEnd.getDate() + 6);\n      if (weekEnd > endDate) {\n        weekEnd.setTime(endDate.getTime());\n      }\n      const weekRequests = requests.filter(request => {\n        const requestDate = new Date(request.createdAt);\n        return requestDate >= weekStart && requestDate <= weekEnd;\n      });\n      weeklyData.push({\n        weekStart: weekStart.toISOString().split('T')[0],\n        weekEnd: weekEnd.toISOString().split('T')[0],\n        count: weekRequests.length,\n        matched: weekRequests.filter(r => r.status === 'matched').length\n      });\n      current.setDate(current.getDate() + 7);\n    }\n    return weeklyData;\n  }\n\n  // 获取优秀志愿者排行\n  static getTopPerformers(requests) {\n    const volunteerStats = {};\n    requests.filter(r => r.status === 'matched' && r.volunteer).forEach(request => {\n      const volunteer = request.volunteer;\n      if (!volunteerStats[volunteer]) {\n        volunteerStats[volunteer] = {\n          name: volunteer,\n          matches: 0,\n          categories: new Set()\n        };\n      }\n      volunteerStats[volunteer].matches++;\n      volunteerStats[volunteer].categories.add(request.category);\n    });\n    return Object.values(volunteerStats).map(v => ({\n      ...v,\n      categories: Array.from(v.categories)\n    })).sort((a, b) => b.matches - a.matches).slice(0, 5);\n  }\n\n  // 生成综合报告\n  static generateComprehensiveReport(reportType = 'monthly', targetDate = new Date()) {\n    let report;\n    switch (reportType) {\n      case 'daily':\n        report = this.generateDailyReport(targetDate);\n        break;\n      case 'weekly':\n        report = this.generateWeeklyReport(targetDate);\n        break;\n      case 'monthly':\n        report = this.generateMonthlyReport(targetDate);\n        break;\n      default:\n        report = this.generateWeeklyReport(targetDate);\n    }\n    return {\n      ...report,\n      generatedAt: new Date().toISOString(),\n      systemInfo: {\n        totalUsers: DataService.getUsers().length,\n        totalRequests: DataService.getRequests().length,\n        systemHealth: 'good'\n      }\n    };\n  }\n\n  // 导出报告为JSON\n  static exportReport(report, filename) {\n    const dataStr = JSON.stringify(report, null, 2);\n    const dataBlob = new Blob([dataStr], {\n      type: 'application/json'\n    });\n    const link = document.createElement('a');\n    link.href = URL.createObjectURL(dataBlob);\n    link.download = `${filename}_${report.reportType}_${new Date().toISOString().split('T')[0]}.json`;\n    document.body.appendChild(link);\n    link.click();\n    document.body.removeChild(link);\n  }\n\n  // 导出报告为CSV（简化版）\n  static exportReportCSV(report, filename) {\n    const csvData = [['指标', '数值', '增长率'], ['总匹配数', report.totalMatches, `${report.trends.matchGrowth}%`], ['新用户', report.newUsers, `${report.trends.userGrowth}%`], ['活跃请求', report.activeRequests, ''], ['完成率', report.completionRate, '']];\n    const csvContent = csvData.map(row => row.join(',')).join('\\n');\n    const csvBlob = new Blob([csvContent], {\n      type: 'text/csv;charset=utf-8;'\n    });\n    const link = document.createElement('a');\n    link.href = URL.createObjectURL(csvBlob);\n    link.download = `${filename}_${report.reportType}_${new Date().toISOString().split('T')[0]}.csv`;\n    document.body.appendChild(link);\n    link.click();\n    document.body.removeChild(link);\n  }\n\n  // 生成并下载综合报告\n  static generateAndDownloadReport(reportType = 'monthly') {\n    const report = this.generateComprehensiveReport(reportType);\n    this.exportReport(report, 'system_report');\n    return report;\n  }\n}","map":{"version":3,"names":["DataService","ReportService","getDateRangeData","startDate","endDate","requests","users","start","Date","end","filteredRequests","filter","request","date","createdAt","filteredUsers","user","registeredAt","generateDailyReport","targetDate","getUsers","getRequests","today","setHours","tomorrow","setDate","getDate","todayRequests","todayUsers","toISOString","yesterday","yesterdayRequests","yesterdayUsers","todayMatched","r","status","length","yesterdayMatched","matchGrowth","Math","round","userGrowth","activeRequests","completedToday","totalProcessedToday","completionRate","reportType","split","totalMatches","newUsers","trends","completionRateChange","details","categoryBreakdown","getCategoryBreakdown","hourlyActivity","getHourlyActivity","userTypeBreakdown","getUserTypeBreakdown","generateWeeklyReport","weekRequests","weekUsers","lastWeekEnd","lastWeekStart","lastWeekRequests","lastWeekUsers","weekMatched","lastWeekMatched","completedWeek","totalProcessedWeek","dateRange","dailyActivity","getDailyActivity","generateMonthlyReport","getFullYear","getMonth","monthRequests","monthUsers","lastMonthEnd","lastMonthStart","lastMonthRequests","lastMonthUsers","monthMatched","lastMonthMatched","completedMonth","totalProcessedMonth","weeklyActivity","getWeeklyActivity","topPerformers","getTopPerformers","categories","getCategories","breakdown","forEach","category","id","name","count","matched","pin","u","userType","csr","admin","hourlyData","Array","from","_","i","hour","getHours","dailyData","current","dayStart","dayEnd","dayRequests","requestDate","push","weeklyData","weekStart","weekEnd","setTime","getTime","volunteerStats","volunteer","matches","Set","add","Object","values","map","v","sort","a","b","slice","generateComprehensiveReport","report","generatedAt","systemInfo","totalUsers","totalRequests","systemHealth","exportReport","filename","dataStr","JSON","stringify","dataBlob","Blob","type","link","document","createElement","href","URL","createObjectURL","download","body","appendChild","click","removeChild","exportReportCSV","csvData","csvContent","row","join","csvBlob","generateAndDownloadReport"],"sources":["D:/Study/CSIT314-GP/src/services/reportService.js"],"sourcesContent":["// 真实数据报告服务\r\n// src/services/reportService.js\r\n\r\nimport { DataService } from './dataService';\r\n\r\nexport class ReportService {\r\n  // 获取指定日期范围的数据\r\n  static getDateRangeData(startDate, endDate, requests, users) {\r\n    const start = new Date(startDate);\r\n    const end = new Date(endDate);\r\n    \r\n    const filteredRequests = requests.filter(request => {\r\n      const date = new Date(request.createdAt);\r\n      return date >= start && date <= end;\r\n    });\r\n    \r\n    const filteredUsers = users.filter(user => {\r\n      const date = new Date(user.registeredAt || user.createdAt);\r\n      return date >= start && date <= end;\r\n    });\r\n    \r\n    return { requests: filteredRequests, users: filteredUsers };\r\n  }\r\n  \r\n  // 生成日报数据\r\n  static generateDailyReport(targetDate = new Date()) {\r\n    const users = DataService.getUsers();\r\n    const requests = DataService.getRequests();\r\n    \r\n    const today = new Date(targetDate);\r\n    today.setHours(0, 0, 0, 0);\r\n    const tomorrow = new Date(today);\r\n    tomorrow.setDate(tomorrow.getDate() + 1);\r\n    \r\n    const { requests: todayRequests, users: todayUsers } = this.getDateRangeData(\r\n      today.toISOString(),\r\n      tomorrow.toISOString(),\r\n      requests,\r\n      users\r\n    );\r\n    \r\n    // 计算昨天的数据用于对比\r\n    const yesterday = new Date(today);\r\n    yesterday.setDate(yesterday.getDate() - 1);\r\n    const { requests: yesterdayRequests, users: yesterdayUsers } = this.getDateRangeData(\r\n      yesterday.toISOString(),\r\n      today.toISOString(),\r\n      requests,\r\n      users\r\n    );\r\n    \r\n    const todayMatched = todayRequests.filter(r => r.status === 'matched').length;\r\n    const yesterdayMatched = yesterdayRequests.filter(r => r.status === 'matched').length;\r\n    \r\n    const matchGrowth = yesterdayMatched === 0 ? (todayMatched > 0 ? 100 : 0) : \r\n      Math.round(((todayMatched - yesterdayMatched) / yesterdayMatched) * 100);\r\n    \r\n    const userGrowth = yesterdayUsers.length === 0 ? (todayUsers.length > 0 ? 100 : 0) :\r\n      Math.round(((todayUsers.length - yesterdayUsers.length) / yesterdayUsers.length) * 100);\r\n    \r\n    const activeRequests = requests.filter(r => r.status === 'pending' || r.status === 'matched').length;\r\n    \r\n    // 计算完成率\r\n    const completedToday = todayRequests.filter(r => r.status === 'completed').length;\r\n    const totalProcessedToday = todayRequests.filter(r => r.status !== 'pending').length;\r\n    const completionRate = totalProcessedToday === 0 ? 0 : \r\n      Math.round((completedToday / totalProcessedToday) * 100);\r\n    \r\n    return {\r\n      reportType: 'daily',\r\n      date: today.toISOString().split('T')[0],\r\n      totalMatches: todayMatched,\r\n      newUsers: todayUsers.length,\r\n      activeRequests: activeRequests,\r\n      completionRate: `${completionRate}%`,\r\n      trends: {\r\n        matchGrowth: matchGrowth,\r\n        userGrowth: userGrowth,\r\n        completionRateChange: 0\r\n      },\r\n      details: {\r\n        categoryBreakdown: this.getCategoryBreakdown(todayRequests),\r\n        hourlyActivity: this.getHourlyActivity(todayRequests),\r\n        userTypeBreakdown: this.getUserTypeBreakdown(todayUsers)\r\n      }\r\n    };\r\n  }\r\n  \r\n  // 生成周报数据\r\n  static generateWeeklyReport(targetDate = new Date()) {\r\n    const users = DataService.getUsers();\r\n    const requests = DataService.getRequests();\r\n    \r\n    const endDate = new Date(targetDate);\r\n    const startDate = new Date(endDate);\r\n    startDate.setDate(startDate.getDate() - 7);\r\n    \r\n    const { requests: weekRequests, users: weekUsers } = this.getDateRangeData(\r\n      startDate.toISOString(),\r\n      endDate.toISOString(),\r\n      requests,\r\n      users\r\n    );\r\n    \r\n    // 计算上周数据用于对比\r\n    const lastWeekEnd = new Date(startDate);\r\n    const lastWeekStart = new Date(lastWeekEnd);\r\n    lastWeekStart.setDate(lastWeekStart.getDate() - 7);\r\n    \r\n    const { requests: lastWeekRequests, users: lastWeekUsers } = this.getDateRangeData(\r\n      lastWeekStart.toISOString(),\r\n      lastWeekEnd.toISOString(),\r\n      requests,\r\n      users\r\n    );\r\n    \r\n    const weekMatched = weekRequests.filter(r => r.status === 'matched').length;\r\n    const lastWeekMatched = lastWeekRequests.filter(r => r.status === 'matched').length;\r\n    \r\n    const matchGrowth = lastWeekMatched === 0 ? (weekMatched > 0 ? 100 : 0) : \r\n      Math.round(((weekMatched - lastWeekMatched) / lastWeekMatched) * 100);\r\n    \r\n    const userGrowth = lastWeekUsers.length === 0 ? (weekUsers.length > 0 ? 100 : 0) :\r\n      Math.round(((weekUsers.length - lastWeekUsers.length) / lastWeekUsers.length) * 100);\r\n    \r\n    const activeRequests = requests.filter(r => r.status === 'pending' || r.status === 'matched').length;\r\n    \r\n    // 计算完成率\r\n    const completedWeek = weekRequests.filter(r => r.status === 'completed').length;\r\n    const totalProcessedWeek = weekRequests.filter(r => r.status !== 'pending').length;\r\n    const completionRate = totalProcessedWeek === 0 ? 0 : \r\n      Math.round((completedWeek / totalProcessedWeek) * 100);\r\n    \r\n    return {\r\n      reportType: 'weekly',\r\n      dateRange: `${startDate.toISOString().split('T')[0]} - ${endDate.toISOString().split('T')[0]}`,\r\n      totalMatches: weekMatched,\r\n      newUsers: weekUsers.length,\r\n      activeRequests: activeRequests,\r\n      completionRate: `${completionRate}%`,\r\n      trends: {\r\n        matchGrowth: matchGrowth,\r\n        userGrowth: userGrowth,\r\n        completionRateChange: 0\r\n      },\r\n      details: {\r\n        categoryBreakdown: this.getCategoryBreakdown(weekRequests),\r\n        dailyActivity: this.getDailyActivity(weekRequests, startDate, endDate),\r\n        userTypeBreakdown: this.getUserTypeBreakdown(weekUsers)\r\n      }\r\n    };\r\n  }\r\n  \r\n  // 生成月报数据\r\n  static generateMonthlyReport(targetDate = new Date()) {\r\n    const users = DataService.getUsers();\r\n    const requests = DataService.getRequests();\r\n    \r\n    const endDate = new Date(targetDate);\r\n    const startDate = new Date(endDate.getFullYear(), endDate.getMonth(), 1);\r\n    \r\n    const { requests: monthRequests, users: monthUsers } = this.getDateRangeData(\r\n      startDate.toISOString(),\r\n      endDate.toISOString(),\r\n      requests,\r\n      users\r\n    );\r\n    \r\n    // 计算上月数据用于对比\r\n    const lastMonthEnd = new Date(startDate);\r\n    lastMonthEnd.setDate(lastMonthEnd.getDate() - 1);\r\n    const lastMonthStart = new Date(lastMonthEnd.getFullYear(), lastMonthEnd.getMonth(), 1);\r\n    \r\n    const { requests: lastMonthRequests, users: lastMonthUsers } = this.getDateRangeData(\r\n      lastMonthStart.toISOString(),\r\n      lastMonthEnd.toISOString(),\r\n      requests,\r\n      users\r\n    );\r\n    \r\n    const monthMatched = monthRequests.filter(r => r.status === 'matched').length;\r\n    const lastMonthMatched = lastMonthRequests.filter(r => r.status === 'matched').length;\r\n    \r\n    const matchGrowth = lastMonthMatched === 0 ? (monthMatched > 0 ? 100 : 0) : \r\n      Math.round(((monthMatched - lastMonthMatched) / lastMonthMatched) * 100);\r\n    \r\n    const userGrowth = lastMonthUsers.length === 0 ? (monthUsers.length > 0 ? 100 : 0) :\r\n      Math.round(((monthUsers.length - lastMonthUsers.length) / lastMonthUsers.length) * 100);\r\n    \r\n    const activeRequests = requests.filter(r => r.status === 'pending' || r.status === 'matched').length;\r\n    \r\n    // 计算完成率\r\n    const completedMonth = monthRequests.filter(r => r.status === 'completed').length;\r\n    const totalProcessedMonth = monthRequests.filter(r => r.status !== 'pending').length;\r\n    const completionRate = totalProcessedMonth === 0 ? 0 : \r\n      Math.round((completedMonth / totalProcessedMonth) * 100);\r\n    \r\n    return {\r\n      reportType: 'monthly',\r\n      dateRange: `${startDate.toISOString().split('T')[0]} - ${endDate.toISOString().split('T')[0]}`,\r\n      totalMatches: monthMatched,\r\n      newUsers: monthUsers.length,\r\n      activeRequests: activeRequests,\r\n      completionRate: `${completionRate}%`,\r\n      trends: {\r\n        matchGrowth: matchGrowth,\r\n        userGrowth: userGrowth,\r\n        completionRateChange: 0\r\n      },\r\n      details: {\r\n        categoryBreakdown: this.getCategoryBreakdown(monthRequests),\r\n        weeklyActivity: this.getWeeklyActivity(monthRequests, startDate, endDate),\r\n        userTypeBreakdown: this.getUserTypeBreakdown(monthUsers),\r\n        topPerformers: this.getTopPerformers(monthRequests)\r\n      }\r\n    };\r\n  }\r\n  \r\n  // 获取分类统计\r\n  static getCategoryBreakdown(requests) {\r\n    const categories = DataService.getCategories();\r\n    const breakdown = {};\r\n    \r\n    categories.forEach(category => {\r\n      breakdown[category.id] = {\r\n        name: category.name,\r\n        count: requests.filter(r => r.category === category.id).length,\r\n        matched: requests.filter(r => r.category === category.id && r.status === 'matched').length\r\n      };\r\n    });\r\n    \r\n    return breakdown;\r\n  }\r\n  \r\n  // 获取用户类型统计\r\n  static getUserTypeBreakdown(users) {\r\n    return {\r\n      pin: users.filter(u => u.userType === 'pin').length,\r\n      csr: users.filter(u => u.userType === 'csr').length,\r\n      admin: users.filter(u => u.userType === 'admin').length\r\n    };\r\n  }\r\n  \r\n  // 获取每小时活动数据\r\n  static getHourlyActivity(requests) {\r\n    const hourlyData = Array.from({ length: 24 }, (_, i) => ({ hour: i, count: 0 }));\r\n    \r\n    requests.forEach(request => {\r\n      const hour = new Date(request.createdAt).getHours();\r\n      hourlyData[hour].count++;\r\n    });\r\n    \r\n    return hourlyData;\r\n  }\r\n  \r\n  // 获取每日活动数据\r\n  static getDailyActivity(requests, startDate, endDate) {\r\n    const dailyData = [];\r\n    const current = new Date(startDate);\r\n    \r\n    while (current <= endDate) {\r\n      const dayStart = new Date(current);\r\n      dayStart.setHours(0, 0, 0, 0);\r\n      const dayEnd = new Date(current);\r\n      dayEnd.setHours(23, 59, 59, 999);\r\n      \r\n      const dayRequests = requests.filter(request => {\r\n        const requestDate = new Date(request.createdAt);\r\n        return requestDate >= dayStart && requestDate <= dayEnd;\r\n      });\r\n      \r\n      dailyData.push({\r\n        date: current.toISOString().split('T')[0],\r\n        count: dayRequests.length,\r\n        matched: dayRequests.filter(r => r.status === 'matched').length\r\n      });\r\n      \r\n      current.setDate(current.getDate() + 1);\r\n    }\r\n    \r\n    return dailyData;\r\n  }\r\n  \r\n  // 获取每周活动数据  \r\n  static getWeeklyActivity(requests, startDate, endDate) {\r\n    const weeklyData = [];\r\n    const current = new Date(startDate);\r\n    \r\n    while (current <= endDate) {\r\n      const weekStart = new Date(current);\r\n      const weekEnd = new Date(current);\r\n      weekEnd.setDate(weekEnd.getDate() + 6);\r\n      \r\n      if (weekEnd > endDate) {\r\n        weekEnd.setTime(endDate.getTime());\r\n      }\r\n      \r\n      const weekRequests = requests.filter(request => {\r\n        const requestDate = new Date(request.createdAt);\r\n        return requestDate >= weekStart && requestDate <= weekEnd;\r\n      });\r\n      \r\n      weeklyData.push({\r\n        weekStart: weekStart.toISOString().split('T')[0],\r\n        weekEnd: weekEnd.toISOString().split('T')[0],\r\n        count: weekRequests.length,\r\n        matched: weekRequests.filter(r => r.status === 'matched').length\r\n      });\r\n      \r\n      current.setDate(current.getDate() + 7);\r\n    }\r\n    \r\n    return weeklyData;\r\n  }\r\n  \r\n  // 获取优秀志愿者排行\r\n  static getTopPerformers(requests) {\r\n    const volunteerStats = {};\r\n    \r\n    requests.filter(r => r.status === 'matched' && r.volunteer).forEach(request => {\r\n      const volunteer = request.volunteer;\r\n      if (!volunteerStats[volunteer]) {\r\n        volunteerStats[volunteer] = {\r\n          name: volunteer,\r\n          matches: 0,\r\n          categories: new Set()\r\n        };\r\n      }\r\n      volunteerStats[volunteer].matches++;\r\n      volunteerStats[volunteer].categories.add(request.category);\r\n    });\r\n    \r\n    return Object.values(volunteerStats)\r\n      .map(v => ({\r\n        ...v,\r\n        categories: Array.from(v.categories)\r\n      }))\r\n      .sort((a, b) => b.matches - a.matches)\r\n      .slice(0, 5);\r\n  }\r\n  \r\n  // 生成综合报告\r\n  static generateComprehensiveReport(reportType = 'monthly', targetDate = new Date()) {\r\n    let report;\r\n    \r\n    switch (reportType) {\r\n      case 'daily':\r\n        report = this.generateDailyReport(targetDate);\r\n        break;\r\n      case 'weekly':\r\n        report = this.generateWeeklyReport(targetDate);\r\n        break;\r\n      case 'monthly':\r\n        report = this.generateMonthlyReport(targetDate);\r\n        break;\r\n      default:\r\n        report = this.generateWeeklyReport(targetDate);\r\n    }\r\n    \r\n    return {\r\n      ...report,\r\n      generatedAt: new Date().toISOString(),\r\n      systemInfo: {\r\n        totalUsers: DataService.getUsers().length,\r\n        totalRequests: DataService.getRequests().length,\r\n        systemHealth: 'good'\r\n      }\r\n    };\r\n  }\r\n  \r\n  // 导出报告为JSON\r\n  static exportReport(report, filename) {\r\n    const dataStr = JSON.stringify(report, null, 2);\r\n    const dataBlob = new Blob([dataStr], { type: 'application/json' });\r\n    \r\n    const link = document.createElement('a');\r\n    link.href = URL.createObjectURL(dataBlob);\r\n    link.download = `${filename}_${report.reportType}_${new Date().toISOString().split('T')[0]}.json`;\r\n    document.body.appendChild(link);\r\n    link.click();\r\n    document.body.removeChild(link);\r\n  }\r\n  \r\n  // 导出报告为CSV（简化版）\r\n  static exportReportCSV(report, filename) {\r\n    const csvData = [\r\n      ['指标', '数值', '增长率'],\r\n      ['总匹配数', report.totalMatches, `${report.trends.matchGrowth}%`],\r\n      ['新用户', report.newUsers, `${report.trends.userGrowth}%`],\r\n      ['活跃请求', report.activeRequests, ''],\r\n      ['完成率', report.completionRate, '']\r\n    ];\r\n    \r\n    const csvContent = csvData.map(row => row.join(',')).join('\\n');\r\n    const csvBlob = new Blob([csvContent], { type: 'text/csv;charset=utf-8;' });\r\n    \r\n    const link = document.createElement('a');\r\n    link.href = URL.createObjectURL(csvBlob);\r\n    link.download = `${filename}_${report.reportType}_${new Date().toISOString().split('T')[0]}.csv`;\r\n    document.body.appendChild(link);\r\n    link.click();\r\n    document.body.removeChild(link);\r\n  }\r\n  \r\n  // 生成并下载综合报告\r\n  static generateAndDownloadReport(reportType = 'monthly') {\r\n    const report = this.generateComprehensiveReport(reportType);\r\n    this.exportReport(report, 'system_report');\r\n    return report;\r\n  }\r\n}"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}