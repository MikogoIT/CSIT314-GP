{"ast":null,"code":"import _objectSpread from\"D:/Study/Git/CSIT314-GP/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import React,{useState}from'react';import{useNavigate,Link}from'react-router-dom';import{useAuth}from'../../context/AuthContext';import{useLanguage}from'../../context/LanguageContext';import LanguageSwitcher from'../../components/Common/LanguageSwitcher';import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";const Register=()=>{const[formData,setFormData]=useState({name:'',email:'',password:'',confirmPassword:'',userType:'',phone:'',organization:'',address:'',birthDate:'',emergencyContact:'',skills:[],adminCode:''});const[error,setError]=useState('');const[isLoading,setIsLoading]=useState(false);const[step,setStep]=useState(1);const{register}=useAuth();const{t}=useLanguage();const navigate=useNavigate();const handleSubmit=async e=>{e.preventDefault();setError('');// 基础验证\nif(!formData.userType){setError(t('auth.register.error.userType'));return;}if(formData.password!==formData.confirmPassword){setError(t('auth.register.error.passwordMismatch'));return;}if(formData.password.length<6){setError(t('auth.register.error.passwordTooShort'));return;}// 特殊验证已移除（不允许注册管理员）\nsetIsLoading(true);const result=await register(formData);if(result.success){// 注册成功后根据用户类型重定向\nswitch(formData.userType){case'pin':navigate('/pin/dashboard');break;case'csr':navigate('/csr/search');break;default:navigate('/');}}else{// 处理错误代码并显示相应的翻译信息\nlet errorMessage=t('common.error');if(result.errorCode){switch(result.errorCode){case'EMAIL_ALREADY_EXISTS':errorMessage=t('auth.register.error.emailExists');break;default:errorMessage=result.error||t('common.error');}}else{errorMessage=result.error||t('common.error');}setError(errorMessage);}setIsLoading(false);};const handleChange=e=>{const{name,value,type,checked}=e.target;if(name==='skills'){if(checked){setFormData(prev=>_objectSpread(_objectSpread({},prev),{},{skills:[...prev.skills,value]}));}else{setFormData(prev=>_objectSpread(_objectSpread({},prev),{},{skills:prev.skills.filter(skill=>skill!==value)}));}}else{setFormData(prev=>_objectSpread(_objectSpread({},prev),{},{[name]:value}));}};const nextStep=()=>{if(step===1){if(!formData.name||!formData.email||!formData.userType){setError(t('auth.register.error.requiredFields'));return;}}setError('');setStep(step+1);};const prevStep=()=>{setError('');setStep(step-1);};return/*#__PURE__*/_jsxs(\"div\",{className:\"auth-container\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"auth-background\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"auth-hero\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"hero-icon\",children:\"\\uD83D\\uDCDD\"}),/*#__PURE__*/_jsx(\"h1\",{className:\"hero-title\",children:t('app.title')}),/*#__PURE__*/_jsx(\"p\",{className:\"hero-subtitle\",children:\"\\u5F00\\u59CB\\u60A8\\u7684\\u5FD7\\u613F\\u670D\\u52A1\\u4E4B\\u65C5\"})]})}),/*#__PURE__*/_jsxs(\"div\",{className:\"auth-card\",style:{maxWidth:'500px'},children:[/*#__PURE__*/_jsx(\"div\",{className:\"auth-header\",children:/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex',justifyContent:'space-between',alignItems:'center',marginBottom:'1rem'},children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h2\",{className:\"auth-title\",children:\"\\u52A0\\u5165CSR\\u5FD7\\u613F\\u8005\\u5339\\u914D\\u7CFB\\u7EDF\"}),/*#__PURE__*/_jsx(\"p\",{className:\"auth-subtitle\",children:\"\\u521B\\u5EFA\\u60A8\\u7684\\u8D26\\u6237\\uFF0C\\u5F00\\u59CB\\u5E2E\\u52A9\\u4ED6\\u4EBA\"})]}),/*#__PURE__*/_jsx(LanguageSwitcher,{})]})}),/*#__PURE__*/_jsx(\"div\",{style:{display:'flex',justifyContent:'center',marginBottom:'2rem'},children:[1,2,3].map(stepNum=>/*#__PURE__*/_jsx(\"div\",{style:{width:'30px',height:'30px',borderRadius:'50%',backgroundColor:step>=stepNum?'var(--primary-color)':'var(--gray-300)',color:step>=stepNum?'white':'var(--gray-600)',display:'flex',alignItems:'center',justifyContent:'center',margin:'0 10px',fontSize:'14px',fontWeight:'600'},children:stepNum},stepNum))}),error&&/*#__PURE__*/_jsx(\"div\",{className:\"message message-error\",children:error}),/*#__PURE__*/_jsxs(\"form\",{className:\"auth-form\",onSubmit:handleSubmit,children:[step===1&&/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"form-label required\",children:\"\\u59D3\\u540D\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",name:\"name\",className:\"form-input\",placeholder:\"\\u8BF7\\u8F93\\u5165\\u60A8\\u7684\\u771F\\u5B9E\\u59D3\\u540D\",value:formData.name,onChange:handleChange,required:true})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"form-label required\",children:\"\\u90AE\\u7BB1\"}),/*#__PURE__*/_jsx(\"input\",{type:\"email\",name:\"email\",className:\"form-input\",placeholder:\"\\u8BF7\\u8F93\\u5165\\u90AE\\u7BB1\\u5730\\u5740\",value:formData.email,onChange:handleChange,required:true})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"form-label required\",children:\"\\u7528\\u6237\\u7C7B\\u578B\"}),/*#__PURE__*/_jsxs(\"select\",{name:\"userType\",className:\"form-select\",value:formData.userType,onChange:handleChange,required:true,children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"\\u9009\\u62E9\\u60A8\\u7684\\u8EAB\\u4EFD\"}),/*#__PURE__*/_jsx(\"option\",{value:\"pin\",children:\"Person-In-Need (PIN) - \\u9700\\u8981\\u5E2E\\u52A9\\u7684\\u4E2A\\u4EBA\"}),/*#__PURE__*/_jsx(\"option\",{value:\"csr\",children:\"CSR\\u4EE3\\u8868 - \\u4F01\\u4E1A\\u5FD7\\u613F\\u8005\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"form-label\",children:\"\\u624B\\u673A\\u53F7\\u7801\"}),/*#__PURE__*/_jsx(\"input\",{type:\"tel\",name:\"phone\",className:\"form-input\",placeholder:\"\\u8BF7\\u8F93\\u5165\\u624B\\u673A\\u53F7\\u7801\",value:formData.phone,onChange:handleChange})]}),/*#__PURE__*/_jsx(\"button\",{type:\"button\",className:\"btn btn-primary btn-full\",onClick:nextStep,children:\"\\u4E0B\\u4E00\\u6B65 \\u2192\"})]}),step===2&&/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"form-label required\",children:\"\\u5BC6\\u7801\"}),/*#__PURE__*/_jsx(\"input\",{type:\"password\",name:\"password\",className:\"form-input\",placeholder:\"\\u81F3\\u5C116\\u4F4D\\u5BC6\\u7801\",value:formData.password,onChange:handleChange,required:true})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"form-label required\",children:\"\\u786E\\u8BA4\\u5BC6\\u7801\"}),/*#__PURE__*/_jsx(\"input\",{type:\"password\",name:\"confirmPassword\",className:\"form-input\",placeholder:\"\\u518D\\u6B21\\u8F93\\u5165\\u5BC6\\u7801\",value:formData.confirmPassword,onChange:handleChange,required:true})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"form-label\",children:\"\\u5730\\u5740\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",name:\"address\",className:\"form-input\",placeholder:\"\\u60A8\\u7684\\u5E38\\u4F4F\\u5730\\u5740\",value:formData.address,onChange:handleChange})]}),/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex',gap:'1rem'},children:[/*#__PURE__*/_jsx(\"button\",{type:\"button\",className:\"btn btn-secondary\",style:{flex:1},onClick:prevStep,children:\"\\u2190 \\u4E0A\\u4E00\\u6B65\"}),/*#__PURE__*/_jsx(\"button\",{type:\"button\",className:\"btn btn-primary\",style:{flex:1},onClick:nextStep,children:\"\\u4E0B\\u4E00\\u6B65 \\u2192\"})]})]}),step===3&&/*#__PURE__*/_jsxs(_Fragment,{children:[formData.userType==='pin'&&/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"form-label\",children:\"\\u51FA\\u751F\\u65E5\\u671F\"}),/*#__PURE__*/_jsx(\"input\",{type:\"date\",name:\"birthDate\",className:\"form-input\",value:formData.birthDate,onChange:handleChange})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"form-label\",children:\"\\u7D27\\u6025\\u8054\\u7CFB\\u4EBA\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",name:\"emergencyContact\",className:\"form-input\",placeholder:\"\\u7D27\\u6025\\u8054\\u7CFB\\u4EBA\\u59D3\\u540D\\u548C\\u7535\\u8BDD\",value:formData.emergencyContact,onChange:handleChange})]})]}),formData.userType==='csr'&&/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"form-label\",children:\"\\u6240\\u5C5E\\u673A\\u6784\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",name:\"organization\",className:\"form-input\",placeholder:\"\\u516C\\u53F8\\u6216\\u7EC4\\u7EC7\\u540D\\u79F0\",value:formData.organization,onChange:handleChange})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"form-label\",children:\"\\u6280\\u80FD\\u4E13\\u957F\"}),/*#__PURE__*/_jsx(\"div\",{className:\"form-checkbox-group\",children:[{value:'medical',label:'医疗护理'},{value:'transport',label:'交通出行'},{value:'technology',label:'技术支持'},{value:'education',label:'教育培训'},{value:'household',label:'家务服务'},{value:'companion',label:'陪伴关怀'}].map(skill=>/*#__PURE__*/_jsxs(\"label\",{className:\"form-checkbox\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"checkbox\",name:\"skills\",value:skill.value,checked:formData.skills.includes(skill.value),onChange:handleChange}),/*#__PURE__*/_jsx(\"span\",{children:skill.label})]},skill.value))})]})]}),/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex',gap:'1rem'},children:[/*#__PURE__*/_jsx(\"button\",{type:\"button\",className:\"btn btn-secondary\",style:{flex:1},onClick:prevStep,children:\"\\u2190 \\u4E0A\\u4E00\\u6B65\"}),/*#__PURE__*/_jsxs(\"button\",{type:\"submit\",className:\"btn btn-primary\",style:{flex:1},disabled:isLoading,children:[isLoading&&/*#__PURE__*/_jsx(\"span\",{className:\"loading-spinner\"}),isLoading?'注册中...':'完成注册']})]})]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"auth-links\",children:/*#__PURE__*/_jsxs(\"p\",{className:\"auth-link\",children:[\"\\u5DF2\\u6709\\u8D26\\u53F7\\uFF1F \",/*#__PURE__*/_jsx(Link,{to:\"/login\",children:\"\\u7ACB\\u5373\\u767B\\u5F55\"})]})})]})]});};export default Register;","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}