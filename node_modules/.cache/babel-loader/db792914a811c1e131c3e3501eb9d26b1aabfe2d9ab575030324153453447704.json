{"ast":null,"code":"import apiService from'./apiService';export class DataService{static isCacheValid(key){const lastFetch=this.cache.lastFetch[key];return lastFetch&&Date.now()-lastFetch<this.CACHE_DURATION;}static updateCache(key,data){this.cache[key]=data;this.cache.lastFetch[key]=Date.now();}static clearCache(){let key=arguments.length>0&&arguments[0]!==undefined?arguments[0]:null;if(key){this.cache[key]=null;delete this.cache.lastFetch[key];}else{this.cache={categories:null,users:null,requests:null,shortlists:null,lastFetch:{}};}}static async getCategories(){try{if(this.isCacheValid('categories')&&this.cache.categories){return this.cache.categories;}const categories=await apiService.getCategories();if(!Array.isArray(categories)){throw new Error('Invalid category data format');}const formattedCategories=categories.map(cat=>({id:cat.name||cat._id,_id:cat._id,name:cat.name,displayName:cat.displayName,icon:cat.icon||'üìÅ',color:this.getColorFromHex(cat.color||'#42a5f5')}));this.updateCache('categories',formattedCategories);return formattedCategories;}catch(error){console.error('Failed to load categories, using defaults:',error);const defaultCategories=[{id:'medical',name:'medical',displayName:'Medical',icon:'üè•',color:'danger'},{id:'transportation',name:'transportation',displayName:'Transportation',icon:'üöó',color:'primary'},{id:'shopping',name:'shopping',displayName:'Shopping',icon:'üõí',color:'warning'},{id:'household',name:'household',displayName:'Household',icon:'üè†',color:'success'},{id:'companion',name:'companion',displayName:'Companion',icon:'üë•',color:'info'},{id:'technology',name:'technology',displayName:'Technology',icon:'üíª',color:'secondary'},{id:'education',name:'education',displayName:'Education',icon:'üìö',color:'primary'},{id:'other',name:'other',displayName:'Other',icon:'üìù',color:'default'}];this.updateCache('categories',defaultCategories);return defaultCategories;}}static getColorFromHex(hexColor){const colorMap={'#ff4757':'danger','#ffa726':'warning','#42a5f5':'primary','#66bb6a':'success','#ab47bc':'info','#26c6da':'secondary'};return colorMap[hexColor]||'primary';}static getUrgencyLevels(){return[{id:'low',name:'urgency.low',color:'success'},{id:'medium',name:'urgency.medium',color:'warning'},{id:'high',name:'urgency.high',color:'danger'},{id:'urgent',name:'urgency.urgent',color:'critical'}];}static getStatusOptions(){return[{id:'pending',name:'status.pending',color:'warning'},{id:'matched',name:'status.matched',color:'success'},{id:'completed',name:'status.completed',color:'info'},{id:'cancelled',name:'status.cancelled',color:'danger'}];}static async getUsers(){try{const currentUser=JSON.parse(localStorage.getItem('user')||'{}');if(currentUser.userType!=='system_admin'&&currentUser.userType!=='platform_manager'){console.warn('getUsers() requires admin permissions');return[];}if(this.isCacheValid('users')&&this.cache.users){return this.cache.users;}const users=await apiService.getAllUsers();this.updateCache('users',users);return users;}catch(error){console.error('Failed to load users:',error);return[];}}static async getRequests(){try{if(this.isCacheValid('requests')&&this.cache.requests){return this.cache.requests;}const currentUser=JSON.parse(localStorage.getItem('user')||'{}');let requests=[];if(currentUser.userType==='system_admin'||currentUser.userType==='platform_manager'){const allRequests=await apiService.getAllRequests();requests=allRequests||[];}else{// ÊôÆÈÄöÁî®Êà∑‰ΩøÁî®getRequestsÔºåÂêéÁ´Ø‰ºöÊ†πÊçÆÁî®Êà∑Á±ªÂûãËøáÊª§\nconst response=await apiService.getRequests();requests=response.requests||response||[];}// ËΩ¨Êç¢Êï∞ÊçÆÊ†ºÂºè‰ª•ÂÖºÂÆπÁé∞Êúâ‰ª£Á†Å\nconst formattedRequests=requests.map(req=>{var _req$category,_req$requester,_req$requester2,_req$requesterId,_req$requester3,_req$requesterId2,_req$requester4,_req$requesterId3,_req$requester5,_req$requesterId4,_req$assignedVoluntee,_req$stats,_req$stats2;// Â§ÑÁêÜÂ∑≤ÂàÜÈÖçÁöÑÂøóÊÑøËÄÖ‰ø°ÊÅØ\nconst assignedVolunteers=req.assignedVolunteers||[];const volunteersList=assignedVolunteers.map(av=>{var _av$volunteer,_av$volunteer2,_av$volunteer3,_av$volunteer4;return{id:((_av$volunteer=av.volunteer)===null||_av$volunteer===void 0?void 0:_av$volunteer._id)||av.volunteer,name:((_av$volunteer2=av.volunteer)===null||_av$volunteer2===void 0?void 0:_av$volunteer2.name)||'Unknown',email:(_av$volunteer3=av.volunteer)===null||_av$volunteer3===void 0?void 0:_av$volunteer3.email,phone:(_av$volunteer4=av.volunteer)===null||_av$volunteer4===void 0?void 0:_av$volunteer4.phone,assignedAt:av.assignedAt,completedAt:av.completedAt,rating:av.rating,feedback:av.feedback};});const interestedVolunteers=req.interestedVolunteers||[];const interestedList=interestedVolunteers.map(iv=>{var _iv$volunteer,_iv$volunteer2,_iv$volunteer3,_iv$volunteer4;return{id:((_iv$volunteer=iv.volunteer)===null||_iv$volunteer===void 0?void 0:_iv$volunteer._id)||iv.volunteer,name:((_iv$volunteer2=iv.volunteer)===null||_iv$volunteer2===void 0?void 0:_iv$volunteer2.name)||'Unknown',email:(_iv$volunteer3=iv.volunteer)===null||_iv$volunteer3===void 0?void 0:_iv$volunteer3.email,phone:(_iv$volunteer4=iv.volunteer)===null||_iv$volunteer4===void 0?void 0:_iv$volunteer4.phone,message:iv.message,appliedAt:iv.appliedAt};});const rejectedVolunteers=req.rejectedVolunteers||[];const rejectedList=rejectedVolunteers.map(rv=>{var _rv$volunteer;return{volunteer:((_rv$volunteer=rv.volunteer)===null||_rv$volunteer===void 0?void 0:_rv$volunteer._id)||rv.volunteer,rejectedAt:rv.rejectedAt,reason:rv.reason};});return{id:req._id,title:req.title,description:req.description,category:((_req$category=req.category)===null||_req$category===void 0?void 0:_req$category.name)||req.category,urgency:req.urgency,location:req.location,expectedDate:req.expectedDate?new Date(req.expectedDate).toISOString().split('T')[0]:null,expectedTime:req.expectedTime,volunteersNeeded:req.volunteersNeeded,status:req.status,requesterId:((_req$requester=req.requester)===null||_req$requester===void 0?void 0:_req$requester._id)||req.requesterId||req.requester,requesterName:((_req$requester2=req.requester)===null||_req$requester2===void 0?void 0:_req$requester2.name)||((_req$requesterId=req.requesterId)===null||_req$requesterId===void 0?void 0:_req$requesterId.name)||req.requesterName||'Unknown',requesterEmail:((_req$requester3=req.requester)===null||_req$requester3===void 0?void 0:_req$requester3.email)||((_req$requesterId2=req.requesterId)===null||_req$requesterId2===void 0?void 0:_req$requesterId2.email)||req.requesterEmail,requesterPhone:((_req$requester4=req.requester)===null||_req$requester4===void 0?void 0:_req$requester4.phone)||((_req$requesterId3=req.requesterId)===null||_req$requesterId3===void 0?void 0:_req$requesterId3.phone)||req.requesterPhone,requesterAddress:((_req$requester5=req.requester)===null||_req$requester5===void 0?void 0:_req$requester5.address)||((_req$requesterId4=req.requesterId)===null||_req$requesterId4===void 0?void 0:_req$requesterId4.address)||req.requesterAddress,interestedVolunteers:interestedList,rejectedVolunteers:rejectedList,assignedVolunteers:volunteersList,volunteer:volunteersList.length>0?volunteersList[0].name:((_req$assignedVoluntee=req.assignedVolunteer)===null||_req$assignedVoluntee===void 0?void 0:_req$assignedVoluntee.name)||req.volunteer,volunteerEmail:volunteersList.length>0?volunteersList[0].email:null,volunteerPhone:volunteersList.length>0?volunteersList[0].phone:null,viewCount:req.viewCount||((_req$stats=req.stats)===null||_req$stats===void 0?void 0:_req$stats.viewCount)||0,shortlistCount:req.shortlistCount||((_req$stats2=req.stats)===null||_req$stats2===void 0?void 0:_req$stats2.shortlistCount)||0,createdAt:req.createdAt,matchedAt:req.matchedAt};});this.updateCache('requests',formattedRequests);return formattedRequests;}catch(error){console.error('Failed to load requests:',error);return[];}}static async getRequestById(requestId){try{const response=await apiService.getRequestById(requestId);return response.request||response;}catch(error){console.error('Failed to load request details:',error);throw error;}}static async getShortlists(){try{if(this.isCacheValid('shortlists')&&this.cache.shortlists){return this.cache.shortlists;}const allShortlists=[];for(let i=0;i<localStorage.length;i++){const key=localStorage.key(i);if(key&&key.startsWith('shortlist_')){try{const shortlist=JSON.parse(localStorage.getItem(key));if(Array.isArray(shortlist)){allShortlists.push(...shortlist);}}catch(parseError){console.warn(\"Failed to parse shortlist data for key \".concat(key));}}}this.updateCache('shortlists',allShortlists);return allShortlists;}catch(error){console.error('Failed to load shortlists:',error);return[];}}static async saveCategories(categories){try{await apiService.updateCategory(categories);this.clearCache('categories');}catch(error){console.error('Failed to save categories:',error);throw error;}}static async saveUsers(users){try{this.clearCache('users');}catch(error){console.error('Failed to save users:',error);throw error;}}static async saveRequests(requests){try{this.clearCache('requests');}catch(error){console.error('Failed to save requests:',error);throw error;}}static async saveShortlists(shortlists){try{this.clearCache('shortlists');}catch(error){console.error('Failed to save shortlists:',error);throw error;}}static async getCategoryById(categoryId){try{const categories=await this.getCategories();const category=categories.find(cat=>cat.id===categoryId);return category||{id:categoryId,name:'category.other',icon:'üìù'};}catch(error){console.error('Failed to get category:',error);return{id:categoryId,name:'category.other',icon:'üìù'};}}static getUrgencyById(urgencyId){const urgencyLevels=this.getUrgencyLevels();return urgencyLevels.find(level=>level.id===urgencyId)||{id:urgencyId,name:'urgency.medium',color:'warning'};}static getStatusById(statusId){const statuses=this.getStatusOptions();return statuses.find(status=>status.id===statusId)||{id:statusId,name:'status.pending',color:'warning'};}static async getUserRequests(userId){try{const requests=await apiService.getUserRequests(userId);console.log('DataService - Original request data:',requests);if(!Array.isArray(requests)){console.error('Request data is not an array:',requests);return[];}const mappedRequests=requests.map(req=>{var _req$location,_req$requester6,_req$requester7,_req$requester8,_req$requester9,_req$assignedVoluntee2,_req$assignedVoluntee3,_req$assignedVoluntee4,_req$stats3,_req$stats4;const interestedVolunteers=req.interestedVolunteers||[];console.log(\"Request \".concat(req._id,\" - interestedVolunteers:\"),interestedVolunteers);const interestedList=interestedVolunteers.map(iv=>{var _iv$volunteer5,_iv$volunteer6,_iv$volunteer7,_iv$volunteer8;return{id:((_iv$volunteer5=iv.volunteer)===null||_iv$volunteer5===void 0?void 0:_iv$volunteer5._id)||iv.volunteer,name:((_iv$volunteer6=iv.volunteer)===null||_iv$volunteer6===void 0?void 0:_iv$volunteer6.name)||'Unknown',email:(_iv$volunteer7=iv.volunteer)===null||_iv$volunteer7===void 0?void 0:_iv$volunteer7.email,phone:(_iv$volunteer8=iv.volunteer)===null||_iv$volunteer8===void 0?void 0:_iv$volunteer8.phone,message:iv.message,appliedAt:iv.appliedAt};});console.log(\"Request \".concat(req._id,\" - \\u5904\\u7406\\u540E\\u7684\\u7533\\u8BF7\\u8005:\"),interestedList);return{id:req._id,title:req.title,description:req.description,category:req.category,urgency:req.urgency,location:((_req$location=req.location)===null||_req$location===void 0?void 0:_req$location.address)||req.location,expectedDate:req.expectedDate?new Date(req.expectedDate).toISOString().split('T')[0]:null,expectedTime:req.expectedTime,volunteersNeeded:req.volunteersNeeded,status:req.status,contactMethod:req.contactMethod,additionalNotes:req.additionalNotes,requesterId:((_req$requester6=req.requester)===null||_req$requester6===void 0?void 0:_req$requester6._id)||req.requesterId,requesterName:((_req$requester7=req.requester)===null||_req$requester7===void 0?void 0:_req$requester7.name)||req.requesterName,requesterEmail:((_req$requester8=req.requester)===null||_req$requester8===void 0?void 0:_req$requester8.email)||req.requesterEmail,requesterPhone:((_req$requester9=req.requester)===null||_req$requester9===void 0?void 0:_req$requester9.phone)||req.requesterPhone,volunteer:((_req$assignedVoluntee2=req.assignedVolunteers)===null||_req$assignedVoluntee2===void 0?void 0:(_req$assignedVoluntee3=_req$assignedVoluntee2[0])===null||_req$assignedVoluntee3===void 0?void 0:(_req$assignedVoluntee4=_req$assignedVoluntee3.volunteer)===null||_req$assignedVoluntee4===void 0?void 0:_req$assignedVoluntee4.name)||req.volunteer,interestedVolunteers:interestedList,viewCount:((_req$stats3=req.stats)===null||_req$stats3===void 0?void 0:_req$stats3.viewCount)||req.viewCount||0,shortlistCount:((_req$stats4=req.stats)===null||_req$stats4===void 0?void 0:_req$stats4.shortlistCount)||req.shortlistCount||0,createdAt:req.createdAt,matchedAt:req.matchedAt};});return mappedRequests;}catch(error){console.error('Failed to load user requests:',error);return[];}}static async getUserShortlists(userId){try{const savedShortlist=localStorage.getItem(\"shortlist_\".concat(userId));return savedShortlist?JSON.parse(savedShortlist):[];}catch(error){console.error('Failed to load user shortlists:',error);return[];}}static getTimeAgo(dateString){let t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:null;if(!dateString)return t?t('common.unknown'):'Êú™Áü•';const now=new Date();const past=new Date(dateString);const diffInMinutes=Math.floor((now-past)/(1000*60));const diffInHours=Math.floor(diffInMinutes/60);const diffInDays=Math.floor(diffInHours/24);if(diffInMinutes<1){return t?t('time.justNow'):'ÂàöÂàö';}if(diffInMinutes<60){return t?t('time.minutesAgo',{count:diffInMinutes}):\"\".concat(diffInMinutes,\"\\u5206\\u949F\\u524D\");}if(diffInHours<24){return t?t('time.hoursAgo',{count:diffInHours}):\"\".concat(diffInHours,\"\\u5C0F\\u65F6\\u524D\");}if(diffInDays<7){return t?t('time.daysAgo',{count:diffInDays}):\"\".concat(diffInDays,\"\\u5929\\u524D\");}const diffInWeeks=Math.floor(diffInDays/7);return t?t('time.weeksAgo',{count:diffInWeeks}):\"\".concat(diffInWeeks,\"\\u5468\\u524D\");}static async initializeData(){try{const requests=await this.getRequests();if(requests.length===0){console.warn('No data in database. Please run backend initialization script:');console.warn('cd backend && node generate-test-data.js');console.warn('or use: npm run generate-data');}}catch(error){console.error('Failed to check database data:',error);}}static filterRequests(requests,filters){return requests.filter(request=>{if(filters.searchText){const searchLower=filters.searchText.toLowerCase();const matchesText=request.title.toLowerCase().includes(searchLower)||request.description.toLowerCase().includes(searchLower)||request.location.toLowerCase().includes(searchLower);if(!matchesText)return false;}// ÂàÜÁ±ªËøáÊª§\nif(filters.category&&filters.category!=='all'){if(request.category!==filters.category)return false;}// Á¥ßÊÄ•Á®ãÂ∫¶ËøáÊª§\nif(filters.urgency&&filters.urgency!=='all'){if(request.urgency!==filters.urgency)return false;}// Áä∂ÊÄÅËøáÊª§\nif(filters.status&&filters.status!=='all'){if(request.status!==filters.status)return false;}return true;});}static async getStatistics(){let userId=arguments.length>0&&arguments[0]!==undefined?arguments[0]:null;try{const users=await this.getUsers();const requests=await this.getRequests();const shortlists=await this.getShortlists();if(userId){const userRequests=requests.filter(r=>r.requesterId===userId);const userShortlists=shortlists.filter(s=>s.userId===userId);return{totalRequests:userRequests.length,matched:userRequests.filter(r=>r.status==='matched').length,pending:userRequests.filter(r=>r.status==='pending').length,completed:userRequests.filter(r=>r.status==='completed').length,totalViews:userRequests.reduce((sum,r)=>sum+(r.viewCount||0),0),totalShortlists:userShortlists.length};}else{return{totalUsers:users.length,activeUsers:users.filter(u=>u.status==='active').length,totalRequests:requests.length,activeRequests:requests.filter(r=>r.status==='pending'||r.status==='matched').length,matchedRequests:requests.filter(r=>r.status==='matched').length,completedRequests:requests.filter(r=>r.status==='completed').length,totalShortlists:shortlists.length};}}catch(error){console.error('Failed to load statistics:',error);return{totalUsers:0,activeUsers:0,totalRequests:0,activeRequests:0,matchedRequests:0,completedRequests:0,totalShortlists:0};}}static async createRequest(requestData){try{var _newRequest$category;let result;if(requestData.attachments&&requestData.attachments.length){result=await apiService.createRequestWithFiles(requestData);}else{result=await apiService.createRequest(requestData);}this.clearCache('requests');const newRequest=result.request||result;return{id:newRequest._id,title:newRequest.title,description:newRequest.description,category:((_newRequest$category=newRequest.category)===null||_newRequest$category===void 0?void 0:_newRequest$category.name)||newRequest.category,urgency:newRequest.urgency,location:newRequest.location,expectedDate:newRequest.expectedDate?new Date(newRequest.expectedDate).toISOString().split('T')[0]:null,expectedTime:newRequest.expectedTime,volunteersNeeded:newRequest.volunteersNeeded,status:newRequest.status,requesterId:newRequest.requesterId,createdAt:newRequest.createdAt};}catch(error){console.error('Failed to create request:',error);throw error;}}static async updateRequest(requestId,updateData){try{const updatedRequest=await apiService.updateRequest(requestId,updateData);this.clearCache('requests');return updatedRequest;}catch(error){console.error('Failed to update request:',error);throw error;}}// Âà†Èô§ËØ∑Ê±Ç\nstatic async deleteRequest(requestId){try{await apiService.deleteRequest(requestId);this.clearCache('requests');}catch(error){console.error('Failed to delete request:',error);throw error;}}static async completeRequest(requestId){let update=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};try{const response=await apiService.completeRequest(requestId,update);this.clearCache('requests');return response;}catch(error){console.error('Failed to complete request:',error);throw error;}}static async matchRequest(requestId,volunteerId){try{const response=await apiService.matchRequest(requestId,volunteerId);this.clearCache('requests');return response;}catch(error){console.error('Failed to match volunteer:',error);throw error;}}static async applyForRequest(requestId){let message=arguments.length>1&&arguments[1]!==undefined?arguments[1]:'';try{const response=await apiService.applyForRequest(requestId,message);this.clearCache('requests');return response;}catch(error){console.error('Failed to apply for request:',error);throw error;}}static async cancelApplication(requestId){try{const response=await apiService.cancelApplication(requestId);this.clearCache('requests');return response;}catch(error){console.error('Failed to cancel application:',error);throw error;}}static async rejectRequest(requestId){let reason=arguments.length>1&&arguments[1]!==undefined?arguments[1]:'';try{const response=await apiService.rejectRequest(requestId,reason);this.clearCache('requests');return response;}catch(error){console.error('Failed to reject request:',error);throw error;}}static async addToShortlist(requestId){try{const result=await apiService.addToShortlist(requestId);this.clearCache('shortlists');return result;}catch(error){console.error('Failed to add to shortlist:',error);throw error;}}static async removeFromShortlist(requestId){try{await apiService.removeFromShortlist(requestId);this.clearCache('shortlists');}catch(error){console.error('Failed to remove from shortlist:',error);throw error;}}static async getRequestsByCategory(categoryId){try{console.log('DataService.getRequestsByCategory called, categoryId:',categoryId);const requests=await apiService.searchRequests({category:categoryId});console.log('API search result:',requests);if(!requests||requests.length===0){console.log('No API results, trying local filter');const allRequests=await this.getRequests();const filteredRequests=(allRequests||[]).filter(req=>{var _req$category2,_req$category3;return req.category===categoryId||((_req$category2=req.category)===null||_req$category2===void 0?void 0:_req$category2.id)===categoryId||((_req$category3=req.category)===null||_req$category3===void 0?void 0:_req$category3.name)===categoryId;});console.log('Local filter result:',filteredRequests);return filteredRequests;}return requests.map(req=>{var _req$category4,_req$requesterId5,_req$requesterId6;return{id:req._id,title:req.title,description:req.description,category:((_req$category4=req.category)===null||_req$category4===void 0?void 0:_req$category4.name)||req.category,urgency:req.urgency,location:req.location,expectedDate:req.expectedDate?new Date(req.expectedDate).toISOString().split('T')[0]:null,expectedTime:req.expectedTime,volunteersNeeded:req.volunteersNeeded,status:req.status,requesterId:((_req$requesterId5=req.requesterId)===null||_req$requesterId5===void 0?void 0:_req$requesterId5._id)||req.requesterId,requesterName:((_req$requesterId6=req.requesterId)===null||_req$requesterId6===void 0?void 0:_req$requesterId6.name)||req.requesterName,createdAt:req.createdAt};});}catch(error){console.error('Failed to get category requests:',error);return[];}}}DataService.cache={categories:null,users:null,requests:null,shortlists:null,lastFetch:{}};DataService.CACHE_DURATION=5*60*1000;","map":{"version":3,"names":["apiService","DataService","isCacheValid","key","lastFetch","cache","Date","now","CACHE_DURATION","updateCache","data","clearCache","arguments","length","undefined","categories","users","requests","shortlists","getCategories","Array","isArray","Error","formattedCategories","map","cat","id","name","_id","displayName","icon","color","getColorFromHex","error","console","defaultCategories","hexColor","colorMap","getUrgencyLevels","getStatusOptions","getUsers","currentUser","JSON","parse","localStorage","getItem","userType","warn","getAllUsers","getRequests","allRequests","getAllRequests","response","formattedRequests","req","_req$category","_req$requester","_req$requester2","_req$requesterId","_req$requester3","_req$requesterId2","_req$requester4","_req$requesterId3","_req$requester5","_req$requesterId4","_req$assignedVoluntee","_req$stats","_req$stats2","assignedVolunteers","volunteersList","av","_av$volunteer","_av$volunteer2","_av$volunteer3","_av$volunteer4","volunteer","email","phone","assignedAt","completedAt","rating","feedback","interestedVolunteers","interestedList","iv","_iv$volunteer","_iv$volunteer2","_iv$volunteer3","_iv$volunteer4","message","appliedAt","rejectedVolunteers","rejectedList","rv","_rv$volunteer","rejectedAt","reason","title","description","category","urgency","location","expectedDate","toISOString","split","expectedTime","volunteersNeeded","status","requesterId","requester","requesterName","requesterEmail","requesterPhone","requesterAddress","address","assignedVolunteer","volunteerEmail","volunteerPhone","viewCount","stats","shortlistCount","createdAt","matchedAt","getRequestById","requestId","request","getShortlists","allShortlists","i","startsWith","shortlist","push","parseError","concat","saveCategories","updateCategory","saveUsers","saveRequests","saveShortlists","getCategoryById","categoryId","find","getUrgencyById","urgencyId","urgencyLevels","level","getStatusById","statusId","statuses","getUserRequests","userId","log","mappedRequests","_req$location","_req$requester6","_req$requester7","_req$requester8","_req$requester9","_req$assignedVoluntee2","_req$assignedVoluntee3","_req$assignedVoluntee4","_req$stats3","_req$stats4","_iv$volunteer5","_iv$volunteer6","_iv$volunteer7","_iv$volunteer8","contactMethod","additionalNotes","getUserShortlists","savedShortlist","getTimeAgo","dateString","t","past","diffInMinutes","Math","floor","diffInHours","diffInDays","count","diffInWeeks","initializeData","filterRequests","filters","filter","searchText","searchLower","toLowerCase","matchesText","includes","getStatistics","userRequests","r","userShortlists","s","totalRequests","matched","pending","completed","totalViews","reduce","sum","totalShortlists","totalUsers","activeUsers","u","activeRequests","matchedRequests","completedRequests","createRequest","requestData","_newRequest$category","result","attachments","createRequestWithFiles","newRequest","updateRequest","updateData","updatedRequest","deleteRequest","completeRequest","update","matchRequest","volunteerId","applyForRequest","cancelApplication","rejectRequest","addToShortlist","removeFromShortlist","getRequestsByCategory","searchRequests","filteredRequests","_req$category2","_req$category3","_req$category4","_req$requesterId5","_req$requesterId6"],"sources":["D:/Study/Git/CSIT314-GP/src/services/dataService.js"],"sourcesContent":["import apiService from './apiService';\r\n\r\nexport class DataService {\r\n  static cache = {\r\n    categories: null,\r\n    users: null,\r\n    requests: null,\r\n    shortlists: null,\r\n    lastFetch: {}\r\n  };\r\n\r\n  static CACHE_DURATION = 5 * 60 * 1000;\r\n\r\n  static isCacheValid(key) {\r\n    const lastFetch = this.cache.lastFetch[key];\r\n    return lastFetch && (Date.now() - lastFetch) < this.CACHE_DURATION;\r\n  }\r\n\r\n  static updateCache(key, data) {\r\n    this.cache[key] = data;\r\n    this.cache.lastFetch[key] = Date.now();\r\n  }\r\n\r\n  static clearCache(key = null) {\r\n    if (key) {\r\n      this.cache[key] = null;\r\n      delete this.cache.lastFetch[key];\r\n    } else {\r\n      this.cache = {\r\n        categories: null,\r\n        users: null,\r\n        requests: null,\r\n        shortlists: null,\r\n        lastFetch: {}\r\n      };\r\n    }\r\n  }\r\n\r\n  static async getCategories() {\r\n    try {\r\n      if (this.isCacheValid('categories') && this.cache.categories) {\r\n        return this.cache.categories;\r\n      }\r\n\r\n      const categories = await apiService.getCategories();\r\n      \r\n      if (!Array.isArray(categories)) {\r\n        throw new Error('Invalid category data format');\r\n      }\r\n      \r\n      const formattedCategories = categories.map(cat => ({\r\n        id: cat.name || cat._id,\r\n        _id: cat._id,\r\n        name: cat.name,\r\n        displayName: cat.displayName,\r\n        icon: cat.icon || 'üìÅ',\r\n        color: this.getColorFromHex(cat.color || '#42a5f5')\r\n      }));\r\n\r\n      this.updateCache('categories', formattedCategories);\r\n      return formattedCategories;\r\n    } catch (error) {\r\n      console.error('Failed to load categories, using defaults:', error);\r\n      const defaultCategories = [\r\n        { id: 'medical', name: 'medical', displayName: 'Medical', icon: 'üè•', color: 'danger' },\r\n        { id: 'transportation', name: 'transportation', displayName: 'Transportation', icon: 'üöó', color: 'primary' },\r\n        { id: 'shopping', name: 'shopping', displayName: 'Shopping', icon: 'üõí', color: 'warning' },\r\n        { id: 'household', name: 'household', displayName: 'Household', icon: 'üè†', color: 'success' },\r\n        { id: 'companion', name: 'companion', displayName: 'Companion', icon: 'üë•', color: 'info' },\r\n        { id: 'technology', name: 'technology', displayName: 'Technology', icon: 'üíª', color: 'secondary' },\r\n        { id: 'education', name: 'education', displayName: 'Education', icon: 'üìö', color: 'primary' },\r\n        { id: 'other', name: 'other', displayName: 'Other', icon: 'üìù', color: 'default' }\r\n      ];\r\n      this.updateCache('categories', defaultCategories);\r\n      return defaultCategories;\r\n    }\r\n  }\r\n\r\n  static getColorFromHex(hexColor) {\r\n    const colorMap = {\r\n      '#ff4757': 'danger',\r\n      '#ffa726': 'warning', \r\n      '#42a5f5': 'primary',\r\n      '#66bb6a': 'success',\r\n      '#ab47bc': 'info',\r\n      '#26c6da': 'secondary'\r\n    };\r\n    return colorMap[hexColor] || 'primary';\r\n  }\r\n\r\n  static getUrgencyLevels() {\r\n    return [\r\n      { id: 'low', name: 'urgency.low', color: 'success' },\r\n      { id: 'medium', name: 'urgency.medium', color: 'warning' },\r\n      { id: 'high', name: 'urgency.high', color: 'danger' },\r\n      { id: 'urgent', name: 'urgency.urgent', color: 'critical' }\r\n    ];\r\n  }\r\n\r\n  static getStatusOptions() {\r\n    return [\r\n      { id: 'pending', name: 'status.pending', color: 'warning' },\r\n      { id: 'matched', name: 'status.matched', color: 'success' },\r\n      { id: 'completed', name: 'status.completed', color: 'info' },\r\n      { id: 'cancelled', name: 'status.cancelled', color: 'danger' }\r\n    ];\r\n  }\r\n\r\n  static async getUsers() {\r\n    try {\r\n      const currentUser = JSON.parse(localStorage.getItem('user') || '{}');\r\n      if (currentUser.userType !== 'system_admin' && currentUser.userType !== 'platform_manager') {\r\n        console.warn('getUsers() requires admin permissions');\r\n        return [];\r\n      }\r\n\r\n      if (this.isCacheValid('users') && this.cache.users) {\r\n        return this.cache.users;\r\n      }\r\n\r\n      const users = await apiService.getAllUsers();\r\n      this.updateCache('users', users);\r\n      return users;\r\n    } catch (error) {\r\n      console.error('Failed to load users:', error);\r\n      return [];\r\n    }\r\n  }\r\n\r\n  static async getRequests() {\r\n    try {\r\n      if (this.isCacheValid('requests') && this.cache.requests) {\r\n        return this.cache.requests;\r\n      }\r\n\r\n      const currentUser = JSON.parse(localStorage.getItem('user') || '{}');\r\n      let requests = [];\r\n      \r\n      if (currentUser.userType === 'system_admin' || currentUser.userType === 'platform_manager') {\r\n        const allRequests = await apiService.getAllRequests();\r\n        requests = allRequests || [];\r\n      } else {\r\n        // ÊôÆÈÄöÁî®Êà∑‰ΩøÁî®getRequestsÔºåÂêéÁ´Ø‰ºöÊ†πÊçÆÁî®Êà∑Á±ªÂûãËøáÊª§\r\n        const response = await apiService.getRequests();\r\n        requests = response.requests || response || [];\r\n      }\r\n      \r\n      // ËΩ¨Êç¢Êï∞ÊçÆÊ†ºÂºè‰ª•ÂÖºÂÆπÁé∞Êúâ‰ª£Á†Å\r\n      const formattedRequests = requests.map(req => {\r\n        // Â§ÑÁêÜÂ∑≤ÂàÜÈÖçÁöÑÂøóÊÑøËÄÖ‰ø°ÊÅØ\r\n        const assignedVolunteers = req.assignedVolunteers || [];\r\n        const volunteersList = assignedVolunteers.map(av => ({\r\n          id: av.volunteer?._id || av.volunteer,\r\n          name: av.volunteer?.name || 'Unknown',\r\n          email: av.volunteer?.email,\r\n          phone: av.volunteer?.phone,\r\n          assignedAt: av.assignedAt,\r\n          completedAt: av.completedAt,\r\n          rating: av.rating,\r\n          feedback: av.feedback\r\n        }));\r\n        \r\n        const interestedVolunteers = req.interestedVolunteers || [];\r\n        const interestedList = interestedVolunteers.map(iv => ({\r\n          id: iv.volunteer?._id || iv.volunteer,\r\n          name: iv.volunteer?.name || 'Unknown',\r\n          email: iv.volunteer?.email,\r\n          phone: iv.volunteer?.phone,\r\n          message: iv.message,\r\n          appliedAt: iv.appliedAt\r\n        }));\r\n        \r\n        const rejectedVolunteers = req.rejectedVolunteers || [];\r\n        const rejectedList = rejectedVolunteers.map(rv => ({\r\n          volunteer: rv.volunteer?._id || rv.volunteer,\r\n          rejectedAt: rv.rejectedAt,\r\n          reason: rv.reason\r\n        }));\r\n        \r\n        return {\r\n          id: req._id,\r\n          title: req.title,\r\n          description: req.description,\r\n          category: req.category?.name || req.category,\r\n          urgency: req.urgency,\r\n          location: req.location,\r\n          expectedDate: req.expectedDate ? new Date(req.expectedDate).toISOString().split('T')[0] : null,\r\n          expectedTime: req.expectedTime,\r\n          volunteersNeeded: req.volunteersNeeded,\r\n          status: req.status,\r\n          requesterId: req.requester?._id || req.requesterId || req.requester,\r\n          requesterName: req.requester?.name || req.requesterId?.name || req.requesterName || 'Unknown',\r\n          requesterEmail: req.requester?.email || req.requesterId?.email || req.requesterEmail,\r\n          requesterPhone: req.requester?.phone || req.requesterId?.phone || req.requesterPhone,\r\n          requesterAddress: req.requester?.address || req.requesterId?.address || req.requesterAddress,\r\n          interestedVolunteers: interestedList,\r\n          rejectedVolunteers: rejectedList,\r\n          assignedVolunteers: volunteersList,\r\n          volunteer: volunteersList.length > 0 ? volunteersList[0].name : (req.assignedVolunteer?.name || req.volunteer),\r\n          volunteerEmail: volunteersList.length > 0 ? volunteersList[0].email : null,\r\n          volunteerPhone: volunteersList.length > 0 ? volunteersList[0].phone : null,\r\n          viewCount: req.viewCount || req.stats?.viewCount || 0,\r\n          shortlistCount: req.shortlistCount || req.stats?.shortlistCount || 0,\r\n          createdAt: req.createdAt,\r\n          matchedAt: req.matchedAt\r\n        };\r\n      });\r\n\r\n      this.updateCache('requests', formattedRequests);\r\n      return formattedRequests;\r\n    } catch (error) {\r\n      console.error('Failed to load requests:', error);\r\n      return [];\r\n    }\r\n  }\r\n\r\n  static async getRequestById(requestId) {\r\n    try {\r\n      const response = await apiService.getRequestById(requestId);\r\n      return response.request || response;\r\n    } catch (error) {\r\n      console.error('Failed to load request details:', error);\r\n      throw error;\r\n    }\r\n  }\r\n\r\n  static async getShortlists() {\r\n    try {\r\n      if (this.isCacheValid('shortlists') && this.cache.shortlists) {\r\n        return this.cache.shortlists;\r\n      }\r\n\r\n      const allShortlists = [];\r\n      for (let i = 0; i < localStorage.length; i++) {\r\n        const key = localStorage.key(i);\r\n        if (key && key.startsWith('shortlist_')) {\r\n          try {\r\n            const shortlist = JSON.parse(localStorage.getItem(key));\r\n            if (Array.isArray(shortlist)) {\r\n              allShortlists.push(...shortlist);\r\n            }\r\n          } catch (parseError) {\r\n            console.warn(`Failed to parse shortlist data for key ${key}`);\r\n          }\r\n        }\r\n      }\r\n      \r\n      this.updateCache('shortlists', allShortlists);\r\n      return allShortlists;\r\n    } catch (error) {\r\n      console.error('Failed to load shortlists:', error);\r\n      return [];\r\n    }\r\n  }\r\n\r\n  static async saveCategories(categories) {\r\n    try {\r\n      await apiService.updateCategory(categories);\r\n      this.clearCache('categories');\r\n    } catch (error) {\r\n      console.error('Failed to save categories:', error);\r\n      throw error;\r\n    }\r\n  }\r\n\r\n  static async saveUsers(users) {\r\n    try {\r\n      this.clearCache('users');\r\n    } catch (error) {\r\n      console.error('Failed to save users:', error);\r\n      throw error;\r\n    }\r\n  }\r\n\r\n  static async saveRequests(requests) {\r\n    try {\r\n      this.clearCache('requests');\r\n    } catch (error) {\r\n      console.error('Failed to save requests:', error);\r\n      throw error;\r\n    }\r\n  }\r\n\r\n  static async saveShortlists(shortlists) {\r\n    try {\r\n      this.clearCache('shortlists');\r\n    } catch (error) {\r\n      console.error('Failed to save shortlists:', error);\r\n      throw error;\r\n    }\r\n  }\r\n\r\n  static async getCategoryById(categoryId) {\r\n    try {\r\n      const categories = await this.getCategories();\r\n      const category = categories.find(cat => cat.id === categoryId);\r\n      return category || { id: categoryId, name: 'category.other', icon: 'üìù' };\r\n    } catch (error) {\r\n      console.error('Failed to get category:', error);\r\n      return { id: categoryId, name: 'category.other', icon: 'üìù' };\r\n    }\r\n  }\r\n\r\n  static getUrgencyById(urgencyId) {\r\n    const urgencyLevels = this.getUrgencyLevels();\r\n    return urgencyLevels.find(level => level.id === urgencyId) || \r\n           { id: urgencyId, name: 'urgency.medium', color: 'warning' };\r\n  }\r\n\r\n  static getStatusById(statusId) {\r\n    const statuses = this.getStatusOptions();\r\n    return statuses.find(status => status.id === statusId) || \r\n           { id: statusId, name: 'status.pending', color: 'warning' };\r\n  }\r\n\r\n  static async getUserRequests(userId) {\r\n    try {\r\n      const requests = await apiService.getUserRequests(userId);\r\n      \r\n      console.log('DataService - Original request data:', requests);\r\n      \r\n      if (!Array.isArray(requests)) {\r\n        console.error('Request data is not an array:', requests);\r\n        return [];\r\n      }\r\n      \r\n      const mappedRequests = requests.map(req => {\r\n        const interestedVolunteers = req.interestedVolunteers || [];\r\n        console.log(`Request ${req._id} - interestedVolunteers:`, interestedVolunteers);\r\n        \r\n        const interestedList = interestedVolunteers.map(iv => ({\r\n          id: iv.volunteer?._id || iv.volunteer,\r\n          name: iv.volunteer?.name || 'Unknown',\r\n          email: iv.volunteer?.email,\r\n          phone: iv.volunteer?.phone,\r\n          message: iv.message,\r\n          appliedAt: iv.appliedAt\r\n        }));\r\n        \r\n        console.log(`Request ${req._id} - Â§ÑÁêÜÂêéÁöÑÁî≥ËØ∑ËÄÖ:`, interestedList);\r\n        \r\n        return {\r\n          id: req._id,\r\n          title: req.title,\r\n          description: req.description,\r\n          category: req.category,\r\n          urgency: req.urgency,\r\n          location: req.location?.address || req.location,\r\n          expectedDate: req.expectedDate ? new Date(req.expectedDate).toISOString().split('T')[0] : null,\r\n          expectedTime: req.expectedTime,\r\n          volunteersNeeded: req.volunteersNeeded,\r\n          status: req.status,\r\n          contactMethod: req.contactMethod,\r\n          additionalNotes: req.additionalNotes,\r\n          requesterId: req.requester?._id || req.requesterId,\r\n          requesterName: req.requester?.name || req.requesterName,\r\n          requesterEmail: req.requester?.email || req.requesterEmail,\r\n          requesterPhone: req.requester?.phone || req.requesterPhone,\r\n          volunteer: req.assignedVolunteers?.[0]?.volunteer?.name || req.volunteer,\r\n          interestedVolunteers: interestedList,\r\n          viewCount: req.stats?.viewCount || req.viewCount || 0,\r\n          shortlistCount: req.stats?.shortlistCount || req.shortlistCount || 0,\r\n          createdAt: req.createdAt,\r\n          matchedAt: req.matchedAt\r\n        };\r\n      });\r\n      \r\n      return mappedRequests;\r\n    } catch (error) {\r\n      console.error('Failed to load user requests:', error);\r\n      return [];\r\n    }\r\n  }\r\n\r\n  static async getUserShortlists(userId) {\r\n    try {\r\n      const savedShortlist = localStorage.getItem(`shortlist_${userId}`);\r\n      return savedShortlist ? JSON.parse(savedShortlist) : [];\r\n    } catch (error) {\r\n      console.error('Failed to load user shortlists:', error);\r\n      return [];\r\n    }\r\n  }\r\n\r\n  static getTimeAgo(dateString, t = null) {\r\n    if (!dateString) return t ? t('common.unknown') : 'Êú™Áü•';\r\n    \r\n    const now = new Date();\r\n    const past = new Date(dateString);\r\n    const diffInMinutes = Math.floor((now - past) / (1000 * 60));\r\n    const diffInHours = Math.floor(diffInMinutes / 60);\r\n    const diffInDays = Math.floor(diffInHours / 24);\r\n    \r\n    if (diffInMinutes < 1) {\r\n      return t ? t('time.justNow') : 'ÂàöÂàö';\r\n    }\r\n    \r\n    if (diffInMinutes < 60) {\r\n      return t ? t('time.minutesAgo', { count: diffInMinutes }) : `${diffInMinutes}ÂàÜÈíüÂâç`;\r\n    }\r\n    \r\n    if (diffInHours < 24) {\r\n      return t ? t('time.hoursAgo', { count: diffInHours }) : `${diffInHours}Â∞èÊó∂Ââç`;\r\n    }\r\n    \r\n    if (diffInDays < 7) {\r\n      return t ? t('time.daysAgo', { count: diffInDays }) : `${diffInDays}Â§©Ââç`;\r\n    }\r\n    \r\n    const diffInWeeks = Math.floor(diffInDays / 7);\r\n    return t ? t('time.weeksAgo', { count: diffInWeeks }) : `${diffInWeeks}Âë®Ââç`;\r\n  }\r\n\r\n  static async initializeData() {\r\n    try {\r\n      const requests = await this.getRequests();\r\n      \r\n      if (requests.length === 0) {\r\n        console.warn('No data in database. Please run backend initialization script:');\r\n        console.warn('cd backend && node generate-test-data.js');\r\n        console.warn('or use: npm run generate-data');\r\n      }\r\n    } catch (error) {\r\n      console.error('Failed to check database data:', error);\r\n    }\r\n  }\r\n\r\n  static filterRequests(requests, filters) {\r\n    return requests.filter(request => {\r\n      if (filters.searchText) {\r\n        const searchLower = filters.searchText.toLowerCase();\r\n        const matchesText = \r\n          request.title.toLowerCase().includes(searchLower) ||\r\n          request.description.toLowerCase().includes(searchLower) ||\r\n          request.location.toLowerCase().includes(searchLower);\r\n        if (!matchesText) return false;\r\n      }\r\n\r\n      // ÂàÜÁ±ªËøáÊª§\r\n      if (filters.category && filters.category !== 'all') {\r\n        if (request.category !== filters.category) return false;\r\n      }\r\n\r\n      // Á¥ßÊÄ•Á®ãÂ∫¶ËøáÊª§\r\n      if (filters.urgency && filters.urgency !== 'all') {\r\n        if (request.urgency !== filters.urgency) return false;\r\n      }\r\n\r\n      // Áä∂ÊÄÅËøáÊª§\r\n      if (filters.status && filters.status !== 'all') {\r\n        if (request.status !== filters.status) return false;\r\n      }\r\n\r\n      return true;\r\n    });\r\n  }\r\n\r\n  static async getStatistics(userId = null) {\r\n    try {\r\n      const users = await this.getUsers();\r\n      const requests = await this.getRequests();\r\n      const shortlists = await this.getShortlists();\r\n\r\n      if (userId) {\r\n        const userRequests = requests.filter(r => r.requesterId === userId);\r\n        const userShortlists = shortlists.filter(s => s.userId === userId);\r\n        \r\n        return {\r\n          totalRequests: userRequests.length,\r\n          matched: userRequests.filter(r => r.status === 'matched').length,\r\n          pending: userRequests.filter(r => r.status === 'pending').length,\r\n          completed: userRequests.filter(r => r.status === 'completed').length,\r\n          totalViews: userRequests.reduce((sum, r) => sum + (r.viewCount || 0), 0),\r\n          totalShortlists: userShortlists.length\r\n        };\r\n      } else {\r\n        return {\r\n          totalUsers: users.length,\r\n          activeUsers: users.filter(u => u.status === 'active').length,\r\n          totalRequests: requests.length,\r\n          activeRequests: requests.filter(r => r.status === 'pending' || r.status === 'matched').length,\r\n          matchedRequests: requests.filter(r => r.status === 'matched').length,\r\n          completedRequests: requests.filter(r => r.status === 'completed').length,\r\n          totalShortlists: shortlists.length\r\n        };\r\n      }\r\n    } catch (error) {\r\n      console.error('Failed to load statistics:', error);\r\n      return {\r\n        totalUsers: 0,\r\n        activeUsers: 0,\r\n        totalRequests: 0,\r\n        activeRequests: 0,\r\n        matchedRequests: 0,\r\n        completedRequests: 0,\r\n        totalShortlists: 0\r\n      };\r\n    }\r\n  }\r\n\r\n  static async createRequest(requestData) {\r\n    try {\r\n      let result;\r\n      if (requestData.attachments && requestData.attachments.length) {\r\n        result = await apiService.createRequestWithFiles(requestData);\r\n      } else {\r\n        result = await apiService.createRequest(requestData);\r\n      }\r\n      this.clearCache('requests');\r\n      \r\n      const newRequest = result.request || result;\r\n      \r\n      return {\r\n        id: newRequest._id,\r\n        title: newRequest.title,\r\n        description: newRequest.description,\r\n        category: newRequest.category?.name || newRequest.category,\r\n        urgency: newRequest.urgency,\r\n        location: newRequest.location,\r\n        expectedDate: newRequest.expectedDate ? new Date(newRequest.expectedDate).toISOString().split('T')[0] : null,\r\n        expectedTime: newRequest.expectedTime,\r\n        volunteersNeeded: newRequest.volunteersNeeded,\r\n        status: newRequest.status,\r\n        requesterId: newRequest.requesterId,\r\n        createdAt: newRequest.createdAt\r\n      };\r\n    } catch (error) {\r\n      console.error('Failed to create request:', error);\r\n      throw error;\r\n    }\r\n  }\r\n\r\n  static async updateRequest(requestId, updateData) {\r\n    try {\r\n      const updatedRequest = await apiService.updateRequest(requestId, updateData);\r\n      this.clearCache('requests');\r\n      return updatedRequest;\r\n    } catch (error) {\r\n      console.error('Failed to update request:', error);\r\n      throw error;\r\n    }\r\n  }\r\n\r\n  // Âà†Èô§ËØ∑Ê±Ç\r\n  static async deleteRequest(requestId) {\r\n    try {\r\n      await apiService.deleteRequest(requestId);\r\n      this.clearCache('requests');\r\n    } catch (error) {\r\n      console.error('Failed to delete request:', error);\r\n      throw error;\r\n    }\r\n  }\r\n\r\n  static async completeRequest(requestId, update = {}) {\r\n    try {\r\n      const response = await apiService.completeRequest(requestId, update);\r\n      this.clearCache('requests');\r\n      return response;\r\n    } catch (error) {\r\n      console.error('Failed to complete request:', error);\r\n      throw error;\r\n    }\r\n  }\r\n\r\n  static async matchRequest(requestId, volunteerId) {\r\n    try {\r\n      const response = await apiService.matchRequest(requestId, volunteerId);\r\n      this.clearCache('requests');\r\n      return response;\r\n    } catch (error) {\r\n      console.error('Failed to match volunteer:', error);\r\n      throw error;\r\n    }\r\n  }\r\n\r\n  static async applyForRequest(requestId, message = '') {\r\n    try {\r\n      const response = await apiService.applyForRequest(requestId, message);\r\n      this.clearCache('requests');\r\n      return response;\r\n    } catch (error) {\r\n      console.error('Failed to apply for request:', error);\r\n      throw error;\r\n    }\r\n  }\r\n\r\n  static async cancelApplication(requestId) {\r\n    try {\r\n      const response = await apiService.cancelApplication(requestId);\r\n      this.clearCache('requests');\r\n      return response;\r\n    } catch (error) {\r\n      console.error('Failed to cancel application:', error);\r\n      throw error;\r\n    }\r\n  }\r\n\r\n  static async rejectRequest(requestId, reason = '') {\r\n    try {\r\n      const response = await apiService.rejectRequest(requestId, reason);\r\n      this.clearCache('requests');\r\n      return response;\r\n    } catch (error) {\r\n      console.error('Failed to reject request:', error);\r\n      throw error;\r\n    }\r\n  }\r\n\r\n  static async addToShortlist(requestId) {\r\n    try {\r\n      const result = await apiService.addToShortlist(requestId);\r\n      this.clearCache('shortlists');\r\n      return result;\r\n    } catch (error) {\r\n      console.error('Failed to add to shortlist:', error);\r\n      throw error;\r\n    }\r\n  }\r\n\r\n  static async removeFromShortlist(requestId) {\r\n    try {\r\n      await apiService.removeFromShortlist(requestId);\r\n      this.clearCache('shortlists');\r\n    } catch (error) {\r\n      console.error('Failed to remove from shortlist:', error);\r\n      throw error;\r\n    }\r\n  }\r\n\r\n  static async getRequestsByCategory(categoryId) {\r\n    try {\r\n      console.log('DataService.getRequestsByCategory called, categoryId:', categoryId);\r\n      \r\n      const requests = await apiService.searchRequests({ category: categoryId });\r\n      console.log('API search result:', requests);\r\n      \r\n      if (!requests || requests.length === 0) {\r\n        console.log('No API results, trying local filter');\r\n        const allRequests = await this.getRequests();\r\n        const filteredRequests = (allRequests || []).filter(req => \r\n          req.category === categoryId || \r\n          req.category?.id === categoryId ||\r\n          req.category?.name === categoryId\r\n        );\r\n        console.log('Local filter result:', filteredRequests);\r\n        return filteredRequests;\r\n      }\r\n      \r\n      return requests.map(req => ({\r\n        id: req._id,\r\n        title: req.title,\r\n        description: req.description,\r\n        category: req.category?.name || req.category,\r\n        urgency: req.urgency,\r\n        location: req.location,\r\n        expectedDate: req.expectedDate ? new Date(req.expectedDate).toISOString().split('T')[0] : null,\r\n        expectedTime: req.expectedTime,\r\n        volunteersNeeded: req.volunteersNeeded,\r\n        status: req.status,\r\n        requesterId: req.requesterId?._id || req.requesterId,\r\n        requesterName: req.requesterId?.name || req.requesterName,\r\n        createdAt: req.createdAt\r\n      }));\r\n    } catch (error) {\r\n      console.error('Failed to get category requests:', error);\r\n      return [];\r\n    }\r\n  }\r\n}"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}