{"ast":null,"code":"import _objectSpread from\"D:/Study/Git/CSIT314-GP/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";// CategoryManagement.jsx - ä»… Platform Manager å¯è®¿é—®\nimport React,{useState,useEffect}from'react';import{useNavigate}from'react-router-dom';import{useAuth}from'../../context/AuthContext';import{useLanguage}from'../../context/LanguageContext';import{DataService}from'../../services/dataService';import apiService from'../../services/apiService';import{isPlatformManager}from'../../utils/permissions';import'../../styles/category-management.css';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const CategoryManagement=()=>{var _selectedRequest$loca,_editingRequest$locat;const navigate=useNavigate();const{user}=useAuth();const{t,currentLanguage}=useLanguage();const[categories,setCategories]=useState([]);const[newCategory,setNewCategory]=useState('');const[selectedCategory,setSelectedCategory]=useState(null);const[categoryRequests,setCategoryRequests]=useState([]);const[showRequestModal,setShowRequestModal]=useState(false);const[selectedRequest,setSelectedRequest]=useState(null);const[showRequestDetail,setShowRequestDetail]=useState(false);const[showEditModal,setShowEditModal]=useState(false);const[editingRequest,setEditingRequest]=useState(null);// æƒé™æ£€æŸ¥ - åªæœ‰ Platform Manager å¯ä»¥è®¿é—®\nuseEffect(()=>{if(!isPlatformManager(user)){alert(t('permission.denied')||'Access Denied: Platform Manager only');navigate('/admin/dashboard');}},[user,navigate,t]);// èŽ·å–åˆ†ç±»æ˜¾ç¤ºåç§°\nconst getCategoryDisplayName=category=>{// å¦‚æžœæœ‰ displayName å­—æ®µï¼Œä½¿ç”¨å®ƒ\nif(category.displayName){return currentLanguage==='zh'?category.displayName.zh:category.displayName.en;}// å¦åˆ™å°è¯•ç¿»è¯‘ï¼ˆå…¼å®¹æ—§æ•°æ®ï¼‰\nconst translationKey=\"category.\".concat(category.name);const translated=t(translationKey);// å¦‚æžœç¿»è¯‘ç»“æžœå°±æ˜¯ç¿»è¯‘é”®æœ¬èº«ï¼Œè¯´æ˜Žæ²¡æœ‰ç¿»è¯‘ï¼Œç›´æŽ¥è¿”å›ž name\nreturn translated===translationKey?category.name:translated;};const handleGoBack=()=>{navigate(-1);// è¿”å›žä¸Šä¸€é¡µ\n};// åŠ è½½ç±»åˆ«æ•°æ®\nuseEffect(()=>{loadCategories();},[]);const loadCategories=async()=>{try{const allCategories=await DataService.getCategories();const allRequests=await DataService.getRequests();// è®¡ç®—æ¯ä¸ªç±»åˆ«çš„è¯·æ±‚æ•°é‡\nconst categoriesWithCounts=(allCategories||[]).map(category=>_objectSpread(_objectSpread({},category),{},{count:(allRequests||[]).filter(request=>request.category===category.id||request.category===category.name).length}));setCategories(categoriesWithCounts);}catch(error){console.error('åŠ è½½ç±»åˆ«æ•°æ®å¤±è´¥:',error);setCategories([]);}};const handleAddCategory=async()=>{if(newCategory.trim()){try{// ç”Ÿæˆè‹±æ–‡æ ‡è¯†ç¬¦ï¼ˆç§»é™¤ä¸­æ–‡å­—ç¬¦ï¼Œè½¬æ¢ä¸ºæ‹¼éŸ³æˆ–ä½¿ç”¨æ—¶é—´æˆ³ï¼‰\nconst generateName=displayName=>{// ç§»é™¤æ‰€æœ‰éžå­—æ¯æ•°å­—å­—ç¬¦ï¼Œå¦‚æžœç»“æžœä¸ºç©ºåˆ™ä½¿ç”¨æ—¶é—´æˆ³\nlet name=displayName.toLowerCase().replace(/[^a-z0-9]/g,'_').replace(/_+/g,'_').replace(/^_|_$/g,'');// å¦‚æžœå¤„ç†åŽä¸ºç©ºï¼ˆå…¨æ˜¯ä¸­æ–‡ï¼‰ï¼Œä½¿ç”¨ category_ + æ—¶é—´æˆ³\nif(!name||name.length===0){name=\"category_\".concat(Date.now());}return name;};// åˆ›å»ºæ–°åˆ†ç±»å¯¹è±¡\nconst newCategoryData={name:generateName(newCategory),displayName:{zh:newCategory.trim(),en:newCategory.trim()},description:{zh:'',en:''},icon:'ðŸ¤',status:'active'};// è°ƒç”¨APIåˆ›å»ºæ–°åˆ†ç±»\nawait apiService.createCategory(newCategoryData);// æ¸…é™¤ç¼“å­˜å¹¶é‡æ–°åŠ è½½\nDataService.clearCache('categories');await loadCategories();setNewCategory('');alert('åˆ†ç±»æ·»åŠ æˆåŠŸ');}catch(error){console.error('æ·»åŠ åˆ†ç±»å¤±è´¥:',error);alert('æ·»åŠ åˆ†ç±»å¤±è´¥: '+(error.message||'æœªçŸ¥é”™è¯¯'));}}};const handleDeleteCategory=async id=>{if(!window.confirm('ç¡®å®šè¦åˆ é™¤è¿™ä¸ªåˆ†ç±»å—ï¼Ÿ')){return;}try{await apiService.deleteCategory(id);// æ¸…é™¤ç¼“å­˜å¹¶é‡æ–°åŠ è½½\nDataService.clearCache('categories');await loadCategories();alert('åˆ†ç±»åˆ é™¤æˆåŠŸ');}catch(error){console.error('åˆ é™¤åˆ†ç±»å¤±è´¥:',error);alert('åˆ é™¤åˆ†ç±»å¤±è´¥: '+(error.message||'æœªçŸ¥é”™è¯¯'));}};const handleViewCategoryRequests=async category=>{try{// ç›´æŽ¥èŽ·å–æ‰€æœ‰è¯·æ±‚ç„¶åŽæœ¬åœ°è¿‡æ»¤ï¼Œç¡®ä¿èƒ½èŽ·å¾—ç»“æžœ\nconst allRequests=await DataService.getRequests();// å¯¹æ‰€æœ‰è¯·æ±‚è¿›è¡Œè¯¦ç»†çš„åˆ†ç±»åŒ¹é…\nconst requests=(allRequests||[]).filter(request=>{var _request$category,_request$category2;// å¤šç§åŒ¹é…æ–¹å¼\nreturn request.category===category.id||((_request$category=request.category)===null||_request$category===void 0?void 0:_request$category.name)===category.id||((_request$category2=request.category)===null||_request$category2===void 0?void 0:_request$category2.id)===category.id||typeof request.category==='string'&&request.category===category.id;});setSelectedCategory(category);setCategoryRequests(requests||[]);setShowRequestModal(true);}catch(error){console.error('èŽ·å–åˆ†ç±»è¯·æ±‚å¤±è´¥:',error);setCategoryRequests([]);setShowRequestModal(true);}};const closeRequestModal=()=>{setShowRequestModal(false);setSelectedCategory(null);setCategoryRequests([]);};// æŸ¥çœ‹è¯·æ±‚è¯¦æƒ…\nconst handleViewRequestDetail=request=>{setSelectedRequest(request);setShowRequestDetail(true);};// ç¼–è¾‘è¯·æ±‚\nconst handleEditRequest=request=>{setEditingRequest(_objectSpread({},request));setShowEditModal(true);};// å†»ç»“/è§£å†»è¯·æ±‚\nconst handleFreezeRequest=async request=>{try{const newStatus=request.status==='frozen'?request.originalStatus||'pending':'frozen';const updatedRequest=_objectSpread(_objectSpread({},request),{},{status:newStatus,originalStatus:newStatus==='frozen'?request.status:undefined,frozenAt:newStatus==='frozen'?new Date().toISOString():undefined,updatedAt:new Date().toISOString()});// æ›´æ–°æœ¬åœ°å­˜å‚¨ä¸­çš„è¯·æ±‚\nconst allRequests=await DataService.getRequests();const updatedRequests=allRequests.map(r=>r.id===request.id?updatedRequest:r);localStorage.setItem('serviceRequests',JSON.stringify(updatedRequests));// æ›´æ–°å½“å‰æ˜¾ç¤ºçš„è¯·æ±‚åˆ—è¡¨\nsetCategoryRequests(categoryRequests.map(r=>r.id===request.id?updatedRequest:r));// é‡æ–°åŠ è½½ç±»åˆ«æ•°æ®ä»¥æ›´æ–°è®¡æ•°\nloadCategories();}catch(error){console.error('å†»ç»“/è§£å†»è¯·æ±‚å¤±è´¥:',error);alert('æ“ä½œå¤±è´¥ï¼Œè¯·é‡è¯•');}};// åˆ é™¤è¯·æ±‚\nconst handleDeleteRequest=async request=>{if(window.confirm(t('admin.categories.confirmDelete')||\"\\u786E\\u5B9A\\u8981\\u5220\\u9664\\u8BF7\\u6C42 \\\"\".concat(request.title,\"\\\" \\u5417\\uFF1F\\u6B64\\u64CD\\u4F5C\\u65E0\\u6CD5\\u64A4\\u9500\\u3002\"))){try{const allRequests=await DataService.getRequests();const filteredRequests=allRequests.filter(r=>r.id!==request.id);localStorage.setItem('serviceRequests',JSON.stringify(filteredRequests));// æ›´æ–°å½“å‰æ˜¾ç¤ºçš„è¯·æ±‚åˆ—è¡¨\nsetCategoryRequests(categoryRequests.filter(r=>r.id!==request.id));// é‡æ–°åŠ è½½ç±»åˆ«æ•°æ®ä»¥æ›´æ–°è®¡æ•°\nloadCategories();}catch(error){console.error('åˆ é™¤è¯·æ±‚å¤±è´¥:',error);alert('åˆ é™¤å¤±è´¥ï¼Œè¯·é‡è¯•');}}};// ä¿å­˜ç¼–è¾‘çš„è¯·æ±‚\nconst handleSaveEditedRequest=async()=>{if(!editingRequest)return;try{const updatedRequest=_objectSpread(_objectSpread({},editingRequest),{},{updatedAt:new Date().toISOString()});const allRequests=await DataService.getRequests();const updatedRequests=allRequests.map(r=>r.id===editingRequest.id?updatedRequest:r);localStorage.setItem('serviceRequests',JSON.stringify(updatedRequests));// æ›´æ–°å½“å‰æ˜¾ç¤ºçš„è¯·æ±‚åˆ—è¡¨\nsetCategoryRequests(categoryRequests.map(r=>r.id===editingRequest.id?updatedRequest:r));setShowEditModal(false);setEditingRequest(null);loadCategories();}catch(error){console.error('ä¿å­˜è¯·æ±‚å¤±è´¥:',error);alert('ä¿å­˜å¤±è´¥ï¼Œè¯·é‡è¯•');}};// å…³é—­è¯¦æƒ…æ¨¡æ€æ¡†\nconst closeRequestDetail=()=>{setShowRequestDetail(false);setSelectedRequest(null);};// å…³é—­ç¼–è¾‘æ¨¡æ€æ¡†\nconst closeEditModal=()=>{setShowEditModal(false);setEditingRequest(null);};return/*#__PURE__*/_jsxs(\"div\",{className:\"admin-page\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"page-header\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"page-nav\",children:/*#__PURE__*/_jsxs(\"button\",{className:\"btn btn-back\",onClick:handleGoBack,title:t('common.back')||'è¿”å›ž',children:[/*#__PURE__*/_jsx(\"span\",{className:\"btn-icon\",children:\"\\u2190\"}),t('common.back')||'è¿”å›ž']})}),/*#__PURE__*/_jsx(\"h1\",{className:\"page-title\",children:t('admin.categories.title')}),/*#__PURE__*/_jsx(\"p\",{className:\"page-subtitle\",children:t('admin.categories.subtitle')})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"card\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"card-header\",children:/*#__PURE__*/_jsx(\"h3\",{className:\"card-title\",children:t('admin.categories.addNew')})}),/*#__PURE__*/_jsx(\"div\",{className:\"card-body\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"input-group\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"text\",className:\"form-input\",placeholder:t('admin.categories.placeholder'),value:newCategory,onChange:e=>setNewCategory(e.target.value),onKeyPress:e=>e.key==='Enter'&&handleAddCategory()}),/*#__PURE__*/_jsxs(\"button\",{className:\"btn btn-primary\",onClick:handleAddCategory,disabled:!newCategory.trim(),children:[/*#__PURE__*/_jsx(\"span\",{className:\"btn-icon\",children:\"+\"}),t('admin.categories.add')]})]})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"card\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"card-header\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"card-title\",children:t('admin.categories.existing')}),/*#__PURE__*/_jsxs(\"span\",{className:\"badge\",children:[categories.length,\" \",t('admin.categories.count')]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"card-body\",children:/*#__PURE__*/_jsx(\"div\",{className:\"category-list\",children:categories.map(category=>/*#__PURE__*/_jsxs(\"div\",{className:\"category-item\",onClick:()=>handleViewCategoryRequests(category),title:category.count>0?t('admin.categories.clickToView')||'ç‚¹å‡»æŸ¥çœ‹ç›¸å…³è¯·æ±‚':'',children:[/*#__PURE__*/_jsxs(\"div\",{className:\"category-info\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"category-icon\",children:\"\\uD83D\\uDCC1\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"category-details\",children:[/*#__PURE__*/_jsx(\"h4\",{className:\"category-name\",children:getCategoryDisplayName(category)}),/*#__PURE__*/_jsxs(\"p\",{className:\"category-count\",children:[category.count,\" \",t('admin.categories.relatedRequests'),category.count>0&&/*#__PURE__*/_jsxs(\"span\",{className:\"click-hint\",children:[\" \\u2022 \",t('admin.categories.clickHint')||'ç‚¹å‡»æŸ¥çœ‹']})]})]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"category-actions\",children:/*#__PURE__*/_jsx(\"button\",{className:\"btn btn-danger btn-sm delete-btn\",onClick:e=>{e.stopPropagation();handleDeleteCategory(category._id||category.id);},title:t('common.delete')||'åˆ é™¤',children:\"\\uD83D\\uDDD1\\uFE0F\"})})]},category.id))})})]}),showRequestModal&&selectedCategory&&/*#__PURE__*/_jsx(\"div\",{className:\"modal-overlay\",onClick:closeRequestModal,children:/*#__PURE__*/_jsxs(\"div\",{className:\"modal-content large\",onClick:e=>e.stopPropagation(),children:[/*#__PURE__*/_jsxs(\"div\",{className:\"modal-header\",children:[/*#__PURE__*/_jsxs(\"h3\",{className:\"modal-title\",children:[getCategoryDisplayName(selectedCategory),\" - \",t('admin.categories.requestList')||'è¯·æ±‚åˆ—è¡¨']}),/*#__PURE__*/_jsx(\"button\",{className:\"modal-close\",onClick:closeRequestModal,children:\"\\xD7\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"modal-body\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"request-stats\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"stat-item\",children:[/*#__PURE__*/_jsxs(\"span\",{className:\"stat-label\",children:[t('admin.categories.totalRequests')||'æ€»è¯·æ±‚æ•°',\":\"]}),/*#__PURE__*/_jsx(\"span\",{className:\"stat-value\",children:categoryRequests.length})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"stat-item\",children:[/*#__PURE__*/_jsxs(\"span\",{className:\"stat-label\",children:[t('admin.categories.pendingRequests')||'å¾…å¤„ç†',\":\"]}),/*#__PURE__*/_jsx(\"span\",{className:\"stat-value\",children:categoryRequests.filter(r=>r.status==='pending').length})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"stat-item\",children:[/*#__PURE__*/_jsxs(\"span\",{className:\"stat-label\",children:[t('admin.categories.matchedRequests')||'å·²åŒ¹é…',\":\"]}),/*#__PURE__*/_jsx(\"span\",{className:\"stat-value\",children:categoryRequests.filter(r=>r.status==='matched').length})]})]}),categoryRequests.length>0?/*#__PURE__*/_jsx(\"div\",{className:\"requests-list\",children:categoryRequests.map(request=>{var _request$location;return/*#__PURE__*/_jsxs(\"div\",{className:\"request-item\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"request-header\",children:[/*#__PURE__*/_jsx(\"h4\",{className:\"request-title\",children:request.title}),/*#__PURE__*/_jsxs(\"div\",{className:\"request-header-right\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"status-badge \".concat(request.status),children:request.status==='frozen'?'å·²å†»ç»“':t(DataService.getStatusById(request.status).name)}),/*#__PURE__*/_jsxs(\"div\",{className:\"request-actions\",children:[/*#__PURE__*/_jsx(\"button\",{className:\"action-btn view-btn\",onClick:()=>handleViewRequestDetail(request),title:\"\\u67E5\\u770B\\u8BE6\\u60C5\",children:\"\\uD83D\\uDC41\\uFE0F\"}),/*#__PURE__*/_jsx(\"button\",{className:\"action-btn edit-btn\",onClick:()=>handleEditRequest(request),title:\"\\u7F16\\u8F91\\u8BF7\\u6C42\",children:\"\\u270F\\uFE0F\"}),/*#__PURE__*/_jsx(\"button\",{className:\"action-btn \".concat(request.status==='frozen'?'unfreeze-btn':'freeze-btn'),onClick:()=>handleFreezeRequest(request),title:request.status==='frozen'?'è§£å†»è¯·æ±‚':'å†»ç»“è¯·æ±‚',children:request.status==='frozen'?'ðŸ”“':'â„ï¸'}),/*#__PURE__*/_jsx(\"button\",{className:\"action-btn delete-btn\",onClick:()=>handleDeleteRequest(request),title:\"\\u5220\\u9664\\u8BF7\\u6C42\",children:\"\\uD83D\\uDDD1\\uFE0F\"})]})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"request-details\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"request-description\",children:request.description}),/*#__PURE__*/_jsxs(\"div\",{className:\"request-meta\",children:[/*#__PURE__*/_jsxs(\"span\",{className:\"meta-item\",children:[/*#__PURE__*/_jsxs(\"strong\",{children:[t('common.urgency')||'ç´§æ€¥ç¨‹åº¦',\":\"]}),t(DataService.getUrgencyById(request.urgency).name)]}),/*#__PURE__*/_jsxs(\"span\",{className:\"meta-item\",children:[/*#__PURE__*/_jsxs(\"strong\",{children:[t('common.location')||'åœ°ç‚¹',\":\"]}),((_request$location=request.location)===null||_request$location===void 0?void 0:_request$location.address)||request.location||'å¾…ç¡®å®š']}),/*#__PURE__*/_jsxs(\"span\",{className:\"meta-item\",children:[/*#__PURE__*/_jsxs(\"strong\",{children:[t('common.createdAt')||'åˆ›å»ºæ—¶é—´',\":\"]}),DataService.getTimeAgo(request.createdAt,t)]}),request.status==='frozen'&&request.frozenAt&&/*#__PURE__*/_jsxs(\"span\",{className:\"meta-item frozen-info\",children:[/*#__PURE__*/_jsx(\"strong\",{children:\"\\u51BB\\u7ED3\\u65F6\\u95F4:\"}),DataService.getTimeAgo(request.frozenAt,t)]})]}),request.volunteer&&/*#__PURE__*/_jsxs(\"div\",{className:\"volunteer-info\",children:[/*#__PURE__*/_jsxs(\"strong\",{children:[t('common.volunteer')||'å¿—æ„¿è€…',\":\"]}),\" \",request.volunteer]})]})]},request.id);})}):/*#__PURE__*/_jsxs(\"div\",{className:\"empty-state\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"empty-icon\",children:\"\\uD83D\\uDCED\"}),/*#__PURE__*/_jsx(\"h3\",{children:t('admin.categories.noRequests')||'æš‚æ— è¯·æ±‚'}),/*#__PURE__*/_jsx(\"p\",{children:t('admin.categories.noRequestsDesc')||'è¯¥ç±»åˆ«ä¸‹è¿˜æ²¡æœ‰ä»»ä½•è¯·æ±‚'})]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"modal-footer\",children:/*#__PURE__*/_jsx(\"button\",{className:\"btn btn-secondary\",onClick:closeRequestModal,children:t('common.close')||'å…³é—­'})})]})}),showRequestDetail&&selectedRequest&&/*#__PURE__*/_jsx(\"div\",{className:\"modal-overlay\",onClick:closeRequestDetail,children:/*#__PURE__*/_jsxs(\"div\",{className:\"modal-content large-modal\",onClick:e=>e.stopPropagation(),children:[/*#__PURE__*/_jsxs(\"div\",{className:\"modal-header\",children:[/*#__PURE__*/_jsx(\"h3\",{children:\"\\u8BF7\\u6C42\\u8BE6\\u60C5\"}),/*#__PURE__*/_jsx(\"button\",{className:\"modal-close\",onClick:closeRequestDetail,children:\"\\xD7\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"modal-body\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"detail-section\",children:[/*#__PURE__*/_jsx(\"h4\",{children:\"\\u57FA\\u672C\\u4FE1\\u606F\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"detail-grid\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"detail-item\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"\\u6807\\u9898:\"}),/*#__PURE__*/_jsx(\"span\",{children:selectedRequest.title})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"detail-item\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"\\u72B6\\u6001:\"}),/*#__PURE__*/_jsx(\"span\",{className:\"status-badge \".concat(selectedRequest.status),children:selectedRequest.status==='frozen'?'å·²å†»ç»“':t(DataService.getStatusById(selectedRequest.status).name)})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"detail-item\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"\\u7D27\\u6025\\u7A0B\\u5EA6:\"}),/*#__PURE__*/_jsx(\"span\",{children:t(DataService.getUrgencyById(selectedRequest.urgency).name)})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"detail-item\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"\\u7C7B\\u522B:\"}),/*#__PURE__*/_jsx(\"span\",{children:selectedCategory?getCategoryDisplayName(selectedCategory):'æœªçŸ¥'})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"detail-item\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"\\u5730\\u70B9:\"}),/*#__PURE__*/_jsx(\"span\",{children:((_selectedRequest$loca=selectedRequest.location)===null||_selectedRequest$loca===void 0?void 0:_selectedRequest$loca.address)||selectedRequest.location||'å¾…ç¡®å®š'})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"detail-item\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"\\u521B\\u5EFA\\u65F6\\u95F4:\"}),/*#__PURE__*/_jsx(\"span\",{children:new Date(selectedRequest.createdAt).toLocaleString('zh-CN')})]}),selectedRequest.updatedAt&&/*#__PURE__*/_jsxs(\"div\",{className:\"detail-item\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"\\u66F4\\u65B0\\u65F6\\u95F4:\"}),/*#__PURE__*/_jsx(\"span\",{children:new Date(selectedRequest.updatedAt).toLocaleString('zh-CN')})]}),selectedRequest.status==='frozen'&&selectedRequest.frozenAt&&/*#__PURE__*/_jsxs(\"div\",{className:\"detail-item\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"\\u51BB\\u7ED3\\u65F6\\u95F4:\"}),/*#__PURE__*/_jsx(\"span\",{children:new Date(selectedRequest.frozenAt).toLocaleString('zh-CN')})]})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"detail-section\",children:[/*#__PURE__*/_jsx(\"h4\",{children:\"\\u8BE6\\u7EC6\\u63CF\\u8FF0\"}),/*#__PURE__*/_jsx(\"p\",{className:\"request-description-full\",children:selectedRequest.description})]}),(selectedRequest.status==='matched'||selectedRequest.status==='completed')&&selectedRequest.assignedVolunteers&&selectedRequest.assignedVolunteers.length>0&&/*#__PURE__*/_jsxs(\"div\",{className:\"detail-section\",children:[/*#__PURE__*/_jsxs(\"h4\",{children:[\"\\u5DF2\\u5206\\u914D\\u5FD7\\u613F\\u8005 (\",selectedRequest.assignedVolunteers.length,\"\\u4EBA)\"]}),selectedRequest.assignedVolunteers.map((volunteer,index)=>/*#__PURE__*/_jsx(\"div\",{className:\"volunteer-card\",style:{marginBottom:'10px',padding:'12px',border:'1px solid #e0e0e0',borderRadius:'6px',backgroundColor:'#f9f9f9'},children:/*#__PURE__*/_jsxs(\"div\",{className:\"detail-grid\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"detail-item\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"\\u59D3\\u540D:\"}),/*#__PURE__*/_jsx(\"span\",{children:volunteer.name||'æœªçŸ¥'})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"detail-item\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"\\u90AE\\u7BB1:\"}),/*#__PURE__*/_jsx(\"span\",{children:volunteer.email||'æœªæä¾›'})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"detail-item\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"\\u7535\\u8BDD:\"}),/*#__PURE__*/_jsx(\"span\",{children:volunteer.phone||'æœªæä¾›'})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"detail-item\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"\\u5206\\u914D\\u65F6\\u95F4:\"}),/*#__PURE__*/_jsx(\"span\",{children:volunteer.assignedAt?new Date(volunteer.assignedAt).toLocaleString('zh-CN'):'æœªçŸ¥'})]}),volunteer.completedAt&&/*#__PURE__*/_jsxs(\"div\",{className:\"detail-item\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"\\u5B8C\\u6210\\u65F6\\u95F4:\"}),/*#__PURE__*/_jsx(\"span\",{children:new Date(volunteer.completedAt).toLocaleString('zh-CN')})]}),volunteer.rating&&/*#__PURE__*/_jsxs(\"div\",{className:\"detail-item\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"\\u8BC4\\u5206:\"}),/*#__PURE__*/_jsx(\"span\",{children:'â­'.repeat(volunteer.rating)})]}),volunteer.feedback&&/*#__PURE__*/_jsxs(\"div\",{className:\"detail-item\",style:{gridColumn:'1 / -1'},children:[/*#__PURE__*/_jsx(\"label\",{children:\"\\u53CD\\u9988:\"}),/*#__PURE__*/_jsx(\"span\",{children:volunteer.feedback})]})]})},index))]}),/*#__PURE__*/_jsxs(\"div\",{className:\"detail-section\",children:[/*#__PURE__*/_jsx(\"h4\",{children:\"\\u7533\\u8BF7\\u4EBA\\u4FE1\\u606F\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"detail-grid\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"detail-item\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"\\u59D3\\u540D:\"}),/*#__PURE__*/_jsx(\"span\",{children:selectedRequest.requesterName||'æœªçŸ¥'})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"detail-item\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"\\u90AE\\u7BB1:\"}),/*#__PURE__*/_jsx(\"span\",{children:selectedRequest.requesterEmail||'æœªæä¾›'})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"detail-item\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"\\u7535\\u8BDD:\"}),/*#__PURE__*/_jsx(\"span\",{children:selectedRequest.requesterPhone||'æœªæä¾›'})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"detail-item\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"\\u5730\\u5740:\"}),/*#__PURE__*/_jsx(\"span\",{children:selectedRequest.requesterAddress||'æœªæä¾›'})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"detail-item\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"\\u9996\\u9009\\u8054\\u7CFB\\u65B9\\u5F0F:\"}),/*#__PURE__*/_jsxs(\"span\",{children:[selectedRequest.contactMethod==='phone'&&'ç”µè¯',selectedRequest.contactMethod==='email'&&'é‚®ç®±',selectedRequest.contactMethod==='both'&&'ç”µè¯å’Œé‚®ç®±',!selectedRequest.contactMethod&&'æœªè®¾ç½®']})]})]})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"modal-footer\",children:[/*#__PURE__*/_jsx(\"button\",{className:\"btn btn-secondary\",onClick:closeRequestDetail,children:\"\\u5173\\u95ED\"}),/*#__PURE__*/_jsx(\"button\",{className:\"btn btn-primary\",onClick:()=>{closeRequestDetail();handleEditRequest(selectedRequest);},children:\"\\u7F16\\u8F91\\u8BF7\\u6C42\"})]})]})}),showEditModal&&editingRequest&&/*#__PURE__*/_jsx(\"div\",{className:\"modal-overlay\",onClick:closeEditModal,children:/*#__PURE__*/_jsxs(\"div\",{className:\"modal-content large-modal\",onClick:e=>e.stopPropagation(),children:[/*#__PURE__*/_jsxs(\"div\",{className:\"modal-header\",children:[/*#__PURE__*/_jsx(\"h3\",{children:\"\\u7F16\\u8F91\\u8BF7\\u6C42\"}),/*#__PURE__*/_jsx(\"button\",{className:\"modal-close\",onClick:closeEditModal,children:\"\\xD7\"})]}),/*#__PURE__*/_jsx(\"div\",{className:\"modal-body\",children:/*#__PURE__*/_jsxs(\"form\",{className:\"edit-form\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"\\u8BF7\\u6C42\\u6807\\u9898\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:editingRequest.title,onChange:e=>setEditingRequest(_objectSpread(_objectSpread({},editingRequest),{},{title:e.target.value})),className:\"form-input\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"\\u8BE6\\u7EC6\\u63CF\\u8FF0\"}),/*#__PURE__*/_jsx(\"textarea\",{value:editingRequest.description,onChange:e=>setEditingRequest(_objectSpread(_objectSpread({},editingRequest),{},{description:e.target.value})),className:\"form-textarea\",rows:4})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-grid\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"\\u7D27\\u6025\\u7A0B\\u5EA6\"}),/*#__PURE__*/_jsxs(\"select\",{value:editingRequest.urgency,onChange:e=>setEditingRequest(_objectSpread(_objectSpread({},editingRequest),{},{urgency:e.target.value})),className:\"form-select\",children:[/*#__PURE__*/_jsx(\"option\",{value:\"low\",children:\"\\u4F4E\"}),/*#__PURE__*/_jsx(\"option\",{value:\"medium\",children:\"\\u4E2D\"}),/*#__PURE__*/_jsx(\"option\",{value:\"high\",children:\"\\u9AD8\"}),/*#__PURE__*/_jsx(\"option\",{value:\"urgent\",children:\"\\u7D27\\u6025\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"\\u72B6\\u6001\"}),/*#__PURE__*/_jsxs(\"select\",{value:editingRequest.status,onChange:e=>setEditingRequest(_objectSpread(_objectSpread({},editingRequest),{},{status:e.target.value})),className:\"form-select\",children:[/*#__PURE__*/_jsx(\"option\",{value:\"pending\",children:\"\\u5F85\\u5904\\u7406\"}),/*#__PURE__*/_jsx(\"option\",{value:\"matched\",children:\"\\u5DF2\\u5339\\u914D\"}),/*#__PURE__*/_jsx(\"option\",{value:\"completed\",children:\"\\u5DF2\\u5B8C\\u6210\"}),/*#__PURE__*/_jsx(\"option\",{value:\"cancelled\",children:\"\\u5DF2\\u53D6\\u6D88\"}),/*#__PURE__*/_jsx(\"option\",{value:\"frozen\",children:\"\\u5DF2\\u51BB\\u7ED3\"})]})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"\\u670D\\u52A1\\u5730\\u70B9\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:((_editingRequest$locat=editingRequest.location)===null||_editingRequest$locat===void 0?void 0:_editingRequest$locat.address)||editingRequest.location||'',onChange:e=>setEditingRequest(_objectSpread(_objectSpread({},editingRequest),{},{location:e.target.value})),className:\"form-input\"})]}),editingRequest.status==='matched'&&/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"\\u5FD7\\u613F\\u8005\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:editingRequest.volunteer||'',onChange:e=>setEditingRequest(_objectSpread(_objectSpread({},editingRequest),{},{volunteer:e.target.value})),className:\"form-input\"})]})]})}),/*#__PURE__*/_jsxs(\"div\",{className:\"modal-footer\",children:[/*#__PURE__*/_jsx(\"button\",{className:\"btn btn-secondary\",onClick:closeEditModal,children:\"\\u53D6\\u6D88\"}),/*#__PURE__*/_jsx(\"button\",{className:\"btn btn-primary\",onClick:handleSaveEditedRequest,children:\"\\u4FDD\\u5B58\\u66F4\\u6539\"})]})]})})]});};export default CategoryManagement;","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}