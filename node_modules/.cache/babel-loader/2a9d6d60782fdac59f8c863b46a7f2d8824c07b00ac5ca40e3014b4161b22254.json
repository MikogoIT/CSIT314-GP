{"ast":null,"code":"// System Logs - ç³»ç»Ÿæ—¥å¿—é¡µé¢ (System Admin Only)\nimport React,{useState,useEffect}from'react';import{useNavigate}from'react-router-dom';import{useAuth}from'../../context/AuthContext';import{useLanguage}from'../../context/LanguageContext';import Navbar from'../../components/Layout/Navbar';import{isSystemAdmin}from'../../utils/permissions';// import apiService from '../../services/apiService';\nimport'../../styles/user-management.css';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const SystemLogs=()=>{const navigate=useNavigate();const{user}=useAuth();const{t}=useLanguage();const[logs,setLogs]=useState([]);const[filteredLogs,setFilteredLogs]=useState([]);const[filterType,setFilterType]=useState('all');const[searchTerm,setSearchTerm]=useState('');const[loading,setLoading]=useState(true);// æƒé™æ£€æŸ¥ - åªæœ‰ System Admin å¯ä»¥è®¿é—®\nuseEffect(()=>{if(!isSystemAdmin(user)){alert(t('permission.denied')||'Access Denied: System Admin only');navigate('/admin/dashboard');}},[user,navigate,t]);// æ¨¡æ‹Ÿæ—¥å¿—æ•°æ®\nuseEffect(()=>{loadSystemLogs();},[]);const loadSystemLogs=()=>{setLoading(true);// æ¨¡æ‹Ÿç³»ç»Ÿæ—¥å¿—æ•°æ®\nconst mockLogs=[{id:1,type:'login',action:'User Login',user:'john.doe@example.com',userType:'pin',timestamp:new Date(Date.now()-1000*60*5).toISOString(),status:'success',ipAddress:'192.168.1.100',details:'Successful login from Chrome browser'},{id:2,type:'login',action:'Failed Login Attempt',user:'unknown@example.com',userType:'unknown',timestamp:new Date(Date.now()-1000*60*15).toISOString(),status:'failed',ipAddress:'192.168.1.105',details:'Invalid credentials - 3 attempts'},{id:3,type:'system',action:'User Account Created',user:'admin@system.com',userType:'system_admin',timestamp:new Date(Date.now()-1000*60*30).toISOString(),status:'success',ipAddress:'192.168.1.1',details:'Created new CSR account: jane.smith@example.com'},{id:4,type:'system',action:'User Account Suspended',user:'admin@system.com',userType:'system_admin',timestamp:new Date(Date.now()-1000*60*45).toISOString(),status:'success',ipAddress:'192.168.1.1',details:'Suspended user account: spam.user@example.com - Reason: Policy violation'},{id:5,type:'login',action:'User Login',user:'volunteer@example.com',userType:'csr',timestamp:new Date(Date.now()-1000*60*60).toISOString(),status:'success',ipAddress:'192.168.1.102',details:'Successful login from Firefox browser'},{id:6,type:'security',action:'Password Reset',user:'user@example.com',userType:'pin',timestamp:new Date(Date.now()-1000*60*90).toISOString(),status:'success',ipAddress:'192.168.1.103',details:'Password reset via email verification'},{id:7,type:'login',action:'Failed Login Attempt',user:'test@example.com',userType:'unknown',timestamp:new Date(Date.now()-1000*60*120).toISOString(),status:'failed',ipAddress:'192.168.1.106',details:'Account locked after 5 failed attempts'},{id:8,type:'system',action:'Database Backup',user:'system',userType:'system',timestamp:new Date(Date.now()-1000*60*180).toISOString(),status:'success',ipAddress:'localhost',details:'Automated daily backup completed successfully'}];setLogs(mockLogs);setFilteredLogs(mockLogs);setLoading(false);};// è¿‡æ»¤æ—¥å¿—\nuseEffect(()=>{let filtered=logs;// ç±»å‹è¿‡æ»¤\nif(filterType!=='all'){filtered=filtered.filter(log=>log.type===filterType);}// æœç´¢è¿‡æ»¤\nif(searchTerm){filtered=filtered.filter(log=>log.user.toLowerCase().includes(searchTerm.toLowerCase())||log.action.toLowerCase().includes(searchTerm.toLowerCase())||log.details.toLowerCase().includes(searchTerm.toLowerCase()));}setFilteredLogs(filtered);},[filterType,searchTerm,logs]);const getStatusColor=status=>{return status==='success'?'status-active':'status-suspended';};const getTypeColor=type=>{const colors={login:'user-type-badge primary',security:'user-type-badge warning',system:'user-type-badge secondary'};return colors[type]||'user-type-badge';};const formatTimestamp=timestamp=>{const date=new Date(timestamp);return date.toLocaleString('zh-CN',{year:'numeric',month:'2-digit',day:'2-digit',hour:'2-digit',minute:'2-digit',second:'2-digit'});};const getTimeAgo=timestamp=>{const now=Date.now();const diff=now-new Date(timestamp).getTime();const minutes=Math.floor(diff/60000);const hours=Math.floor(minutes/60);const days=Math.floor(hours/24);if(days>0)return\"\".concat(days,\"\\u5929\\u524D\");if(hours>0)return\"\".concat(hours,\"\\u5C0F\\u65F6\\u524D\");if(minutes>0)return\"\".concat(minutes,\"\\u5206\\u949F\\u524D\");return'åˆšåˆš';};return/*#__PURE__*/_jsxs(\"div\",{className:\"user-management-container\",children:[/*#__PURE__*/_jsx(Navbar,{userType:user===null||user===void 0?void 0:user.userType,user:user}),/*#__PURE__*/_jsxs(\"div\",{className:\"user-management-content\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"page-header\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"header-content\",children:[/*#__PURE__*/_jsxs(\"button\",{onClick:()=>navigate('/admin/dashboard'),className:\"back-button\",children:[\"\\u2190 \",t('common.back')||'è¿”å›']}),/*#__PURE__*/_jsxs(\"div\",{className:\"header-text\",children:[/*#__PURE__*/_jsxs(\"h1\",{className:\"page-title\",children:[\"\\uD83D\\uDCCB \",t('admin.systemLogs.title')||'ç³»ç»Ÿæ—¥å¿—']}),/*#__PURE__*/_jsx(\"p\",{className:\"page-subtitle\",children:t('admin.systemLogs.subtitle')||'ç›‘æ§ç³»ç»Ÿæ´»åŠ¨å’Œç™»å½•å°è¯•'})]})]})}),/*#__PURE__*/_jsxs(\"div\",{className:\"stats-grid\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"stat-card\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"stat-icon\",children:\"\\uD83D\\uDCCA\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"stat-content\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"stat-label\",children:t('admin.systemLogs.totalLogs')||'æ€»æ—¥å¿—æ•°'}),/*#__PURE__*/_jsx(\"div\",{className:\"stat-value\",children:logs.length})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"stat-card\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"stat-icon\",children:\"\\u2705\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"stat-content\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"stat-label\",children:t('admin.systemLogs.successfulLogins')||'æˆåŠŸç™»å½•'}),/*#__PURE__*/_jsx(\"div\",{className:\"stat-value\",children:logs.filter(l=>l.type==='login'&&l.status==='success').length})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"stat-card\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"stat-icon\",children:\"\\u274C\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"stat-content\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"stat-label\",children:t('admin.systemLogs.failedAttempts')||'å¤±è´¥å°è¯•'}),/*#__PURE__*/_jsx(\"div\",{className:\"stat-value\",children:logs.filter(l=>l.status==='failed').length})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"stat-card\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"stat-icon\",children:\"\\uD83D\\uDD27\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"stat-content\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"stat-label\",children:t('admin.systemLogs.systemActions')||'ç³»ç»Ÿæ“ä½œ'}),/*#__PURE__*/_jsx(\"div\",{className:\"stat-value\",children:logs.filter(l=>l.type==='system').length})]})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"filters-section\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"filter-tabs\",children:[/*#__PURE__*/_jsxs(\"button\",{className:\"filter-tab \".concat(filterType==='all'?'active':''),onClick:()=>setFilterType('all'),children:[t('common.all')||'å…¨éƒ¨',\" (\",logs.length,\")\"]}),/*#__PURE__*/_jsxs(\"button\",{className:\"filter-tab \".concat(filterType==='login'?'active':''),onClick:()=>setFilterType('login'),children:[\"\\uD83D\\uDD10 \",t('admin.systemLogs.loginLogs')||'ç™»å½•æ—¥å¿—',\" (\",logs.filter(l=>l.type==='login').length,\")\"]}),/*#__PURE__*/_jsxs(\"button\",{className:\"filter-tab \".concat(filterType==='security'?'active':''),onClick:()=>setFilterType('security'),children:[\"\\uD83D\\uDD12 \",t('admin.systemLogs.securityLogs')||'å®‰å…¨æ—¥å¿—',\" (\",logs.filter(l=>l.type==='security').length,\")\"]}),/*#__PURE__*/_jsxs(\"button\",{className:\"filter-tab \".concat(filterType==='system'?'active':''),onClick:()=>setFilterType('system'),children:[\"\\u2699\\uFE0F \",t('admin.systemLogs.systemLogs')||'ç³»ç»Ÿæ—¥å¿—',\" (\",logs.filter(l=>l.type==='system').length,\")\"]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"search-box\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"search-icon\",children:\"\\uD83D\\uDD0D\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",placeholder:t('admin.systemLogs.searchPlaceholder')||'æœç´¢ç”¨æˆ·ã€æ“ä½œæˆ–è¯¦æƒ…...',value:searchTerm,onChange:e=>setSearchTerm(e.target.value),className:\"search-input\"})]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"table-container\",children:loading?/*#__PURE__*/_jsxs(\"div\",{className:\"loading-state\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"loading-spinner\",children:\"\\u23F3\"}),/*#__PURE__*/_jsx(\"p\",{children:t('common.loading')||'åŠ è½½ä¸­...'})]}):filteredLogs.length===0?/*#__PURE__*/_jsxs(\"div\",{className:\"empty-state\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"empty-icon\",children:\"\\uD83D\\uDCCB\"}),/*#__PURE__*/_jsx(\"h3\",{children:t('admin.systemLogs.noLogs')||'æš‚æ— æ—¥å¿—'}),/*#__PURE__*/_jsx(\"p\",{children:t('admin.systemLogs.noLogsDesc')||'æ²¡æœ‰æ‰¾åˆ°åŒ¹é…çš„æ—¥å¿—è®°å½•'})]}):/*#__PURE__*/_jsxs(\"table\",{className:\"data-table\",children:[/*#__PURE__*/_jsx(\"thead\",{children:/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"th\",{children:t('admin.systemLogs.time')||'æ—¶é—´'}),/*#__PURE__*/_jsx(\"th\",{children:t('admin.systemLogs.type')||'ç±»å‹'}),/*#__PURE__*/_jsx(\"th\",{children:t('admin.systemLogs.action')||'æ“ä½œ'}),/*#__PURE__*/_jsx(\"th\",{children:t('admin.systemLogs.user')||'ç”¨æˆ·'}),/*#__PURE__*/_jsx(\"th\",{children:t('admin.systemLogs.status')||'çŠ¶æ€'}),/*#__PURE__*/_jsx(\"th\",{children:t('admin.systemLogs.ipAddress')||'IPåœ°å€'}),/*#__PURE__*/_jsx(\"th\",{children:t('admin.systemLogs.details')||'è¯¦æƒ…'})]})}),/*#__PURE__*/_jsx(\"tbody\",{children:filteredLogs.map(log=>/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"td\",{children:/*#__PURE__*/_jsxs(\"div\",{className:\"timestamp-cell\",children:[/*#__PURE__*/_jsx(\"div\",{children:formatTimestamp(log.timestamp)}),/*#__PURE__*/_jsx(\"small\",{style:{color:'#666'},children:getTimeAgo(log.timestamp)})]})}),/*#__PURE__*/_jsx(\"td\",{children:/*#__PURE__*/_jsx(\"span\",{className:getTypeColor(log.type),children:log.type==='login'?'ğŸ” ç™»å½•':log.type==='security'?'ğŸ”’ å®‰å…¨':'âš™ï¸ ç³»ç»Ÿ'})}),/*#__PURE__*/_jsx(\"td\",{children:log.action}),/*#__PURE__*/_jsx(\"td\",{children:/*#__PURE__*/_jsxs(\"div\",{children:[log.user,log.userType!=='unknown'&&log.userType!=='system'&&/*#__PURE__*/_jsx(\"div\",{style:{fontSize:'0.85em',color:'#666'},children:log.userType==='pin'?'PIN':log.userType==='csr'?'CSR':log.userType})]})}),/*#__PURE__*/_jsx(\"td\",{children:/*#__PURE__*/_jsx(\"span\",{className:\"status-badge \".concat(getStatusColor(log.status)),children:log.status==='success'?'âœ… æˆåŠŸ':'âŒ å¤±è´¥'})}),/*#__PURE__*/_jsx(\"td\",{children:/*#__PURE__*/_jsx(\"code\",{children:log.ipAddress})}),/*#__PURE__*/_jsx(\"td\",{className:\"details-cell\",children:log.details})]},log.id))})]})})]})]});};export default SystemLogs;","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}