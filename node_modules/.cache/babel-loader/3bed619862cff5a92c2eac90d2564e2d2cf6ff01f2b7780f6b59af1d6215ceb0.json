{"ast":null,"code":"/**\r\n * 权限管理工具\r\n * 根据用户类型检查权限\r\n */// System Admin 权限\nexport const SYSTEM_ADMIN_PERMISSIONS={// 用户管理\nVIEW_ALL_USERS:'view_all_users',// #50\nCREATE_USER:'create_user',// #70, #55\nUPDATE_USER:'update_user',// #70\nSUSPEND_USER:'suspend_user',// #52\nDELETE_USER:'delete_user',// 系统监控\nVIEW_SYSTEM_LOGS:'view_system_logs',// #51\nVIEW_LOGIN_ACTIVITY:'view_login_activity',// #51\nCONFIGURE_ALERTS:'configure_alerts',// 系统设置\nSET_FILE_LIMITS:'set_file_limits',// #56\nCONFIGURE_SYSTEM:'configure_system'};// Platform Manager 权限\nexport const PLATFORM_MANAGER_PERMISSIONS={// 类别管理\nMANAGE_CATEGORIES:'manage_categories',// #57\nCREATE_CATEGORY:'create_category',// #57\nEDIT_CATEGORY:'edit_category',// #57\nDELETE_CATEGORY:'delete_category',// #57\n// 报告和分析\nGENERATE_REPORTS:'generate_reports',// #58\nVIEW_PARTICIPATION_METRICS:'view_participation_metrics',// #59\nVIEW_EFFICIENCY_METRICS:'view_efficiency_metrics',// #60\nVIEW_CSR_PERFORMANCE:'view_csr_performance',// #62\n// 统计数据\nVIEW_SYSTEM_STATS:'view_system_stats'// #60\n};// 共享权限（两种管理员都有）\nexport const SHARED_ADMIN_PERMISSIONS={VIEW_DASHBOARD:'view_dashboard',VIEW_BASIC_STATS:'view_basic_stats'};/**\r\n * 检查用户是否有特定权限\r\n * @param {Object} user - 用户对象\r\n * @param {string} permission - 权限名称\r\n * @returns {boolean}\r\n */export const hasPermission=(user,permission)=>{if(!user||!user.userType)return false;const userType=user.userType;// 检查共享权限\nif(Object.values(SHARED_ADMIN_PERMISSIONS).includes(permission)){return userType==='system_admin'||userType==='platform_manager';}// 检查 System Admin 权限\nif(Object.values(SYSTEM_ADMIN_PERMISSIONS).includes(permission)){return userType==='system_admin';}// 检查 Platform Manager 权限\nif(Object.values(PLATFORM_MANAGER_PERMISSIONS).includes(permission)){return userType==='platform_manager';}return false;};/**\r\n * 检查用户是否是系统管理员\r\n */export const isSystemAdmin=user=>{return(user===null||user===void 0?void 0:user.userType)==='system_admin';};/**\r\n * 检查用户是否是平台管理者\r\n */export const isPlatformManager=user=>{return(user===null||user===void 0?void 0:user.userType)==='platform_manager';};/**\r\n * 检查用户是否是任意类型的管理员\r\n */export const isAnyAdmin=user=>{return isSystemAdmin(user)||isPlatformManager(user);};/**\r\n * 获取用户的所有权限列表\r\n */export const getUserPermissions=user=>{if(!user)return[];const permissions=[...Object.values(SHARED_ADMIN_PERMISSIONS)];if(isSystemAdmin(user)){permissions.push(...Object.values(SYSTEM_ADMIN_PERMISSIONS));}if(isPlatformManager(user)){permissions.push(...Object.values(PLATFORM_MANAGER_PERMISSIONS));}return permissions;};/**\r\n * 获取用户角色的显示名称\r\n */export const getRoleDisplayName=(userType,t)=>{const roleNames={system_admin:t?t('roles.systemAdmin'):'System Admin',platform_manager:t?t('roles.platformManager'):'Platform Manager',pin:t?t('roles.pin.name'):'PIN',csr:t?t('roles.csr.name'):'CSR'};return roleNames[userType]||userType;};","map":{"version":3,"names":["SYSTEM_ADMIN_PERMISSIONS","VIEW_ALL_USERS","CREATE_USER","UPDATE_USER","SUSPEND_USER","DELETE_USER","VIEW_SYSTEM_LOGS","VIEW_LOGIN_ACTIVITY","CONFIGURE_ALERTS","SET_FILE_LIMITS","CONFIGURE_SYSTEM","PLATFORM_MANAGER_PERMISSIONS","MANAGE_CATEGORIES","CREATE_CATEGORY","EDIT_CATEGORY","DELETE_CATEGORY","GENERATE_REPORTS","VIEW_PARTICIPATION_METRICS","VIEW_EFFICIENCY_METRICS","VIEW_CSR_PERFORMANCE","VIEW_SYSTEM_STATS","SHARED_ADMIN_PERMISSIONS","VIEW_DASHBOARD","VIEW_BASIC_STATS","hasPermission","user","permission","userType","Object","values","includes","isSystemAdmin","isPlatformManager","isAnyAdmin","getUserPermissions","permissions","push","getRoleDisplayName","t","roleNames","system_admin","platform_manager","pin","csr"],"sources":["D:/Study/Git/CSIT314-GP/src/utils/permissions.js"],"sourcesContent":["/**\r\n * 权限管理工具\r\n * 根据用户类型检查权限\r\n */\r\n\r\n// System Admin 权限\r\nexport const SYSTEM_ADMIN_PERMISSIONS = {\r\n  // 用户管理\r\n  VIEW_ALL_USERS: 'view_all_users', // #50\r\n  CREATE_USER: 'create_user', // #70, #55\r\n  UPDATE_USER: 'update_user', // #70\r\n  SUSPEND_USER: 'suspend_user', // #52\r\n  DELETE_USER: 'delete_user',\r\n  \r\n  // 系统监控\r\n  VIEW_SYSTEM_LOGS: 'view_system_logs', // #51\r\n  VIEW_LOGIN_ACTIVITY: 'view_login_activity', // #51\r\n  CONFIGURE_ALERTS: 'configure_alerts',\r\n  \r\n  // 系统设置\r\n  SET_FILE_LIMITS: 'set_file_limits', // #56\r\n  CONFIGURE_SYSTEM: 'configure_system',\r\n};\r\n\r\n// Platform Manager 权限\r\nexport const PLATFORM_MANAGER_PERMISSIONS = {\r\n  // 类别管理\r\n  MANAGE_CATEGORIES: 'manage_categories', // #57\r\n  CREATE_CATEGORY: 'create_category', // #57\r\n  EDIT_CATEGORY: 'edit_category', // #57\r\n  DELETE_CATEGORY: 'delete_category', // #57\r\n  \r\n  // 报告和分析\r\n  GENERATE_REPORTS: 'generate_reports', // #58\r\n  VIEW_PARTICIPATION_METRICS: 'view_participation_metrics', // #59\r\n  VIEW_EFFICIENCY_METRICS: 'view_efficiency_metrics', // #60\r\n  VIEW_CSR_PERFORMANCE: 'view_csr_performance', // #62\r\n  \r\n  // 统计数据\r\n  VIEW_SYSTEM_STATS: 'view_system_stats', // #60\r\n};\r\n\r\n// 共享权限（两种管理员都有）\r\nexport const SHARED_ADMIN_PERMISSIONS = {\r\n  VIEW_DASHBOARD: 'view_dashboard',\r\n  VIEW_BASIC_STATS: 'view_basic_stats',\r\n};\r\n\r\n/**\r\n * 检查用户是否有特定权限\r\n * @param {Object} user - 用户对象\r\n * @param {string} permission - 权限名称\r\n * @returns {boolean}\r\n */\r\nexport const hasPermission = (user, permission) => {\r\n  if (!user || !user.userType) return false;\r\n  \r\n  const userType = user.userType;\r\n  \r\n  // 检查共享权限\r\n  if (Object.values(SHARED_ADMIN_PERMISSIONS).includes(permission)) {\r\n    return userType === 'system_admin' || userType === 'platform_manager';\r\n  }\r\n  \r\n  // 检查 System Admin 权限\r\n  if (Object.values(SYSTEM_ADMIN_PERMISSIONS).includes(permission)) {\r\n    return userType === 'system_admin';\r\n  }\r\n  \r\n  // 检查 Platform Manager 权限\r\n  if (Object.values(PLATFORM_MANAGER_PERMISSIONS).includes(permission)) {\r\n    return userType === 'platform_manager';\r\n  }\r\n  \r\n  return false;\r\n};\r\n\r\n/**\r\n * 检查用户是否是系统管理员\r\n */\r\nexport const isSystemAdmin = (user) => {\r\n  return user?.userType === 'system_admin';\r\n};\r\n\r\n/**\r\n * 检查用户是否是平台管理者\r\n */\r\nexport const isPlatformManager = (user) => {\r\n  return user?.userType === 'platform_manager';\r\n};\r\n\r\n/**\r\n * 检查用户是否是任意类型的管理员\r\n */\r\nexport const isAnyAdmin = (user) => {\r\n  return isSystemAdmin(user) || isPlatformManager(user);\r\n};\r\n\r\n/**\r\n * 获取用户的所有权限列表\r\n */\r\nexport const getUserPermissions = (user) => {\r\n  if (!user) return [];\r\n  \r\n  const permissions = [...Object.values(SHARED_ADMIN_PERMISSIONS)];\r\n  \r\n  if (isSystemAdmin(user)) {\r\n    permissions.push(...Object.values(SYSTEM_ADMIN_PERMISSIONS));\r\n  }\r\n  \r\n  if (isPlatformManager(user)) {\r\n    permissions.push(...Object.values(PLATFORM_MANAGER_PERMISSIONS));\r\n  }\r\n  \r\n  return permissions;\r\n};\r\n\r\n/**\r\n * 获取用户角色的显示名称\r\n */\r\nexport const getRoleDisplayName = (userType, t) => {\r\n  const roleNames = {\r\n    system_admin: t ? t('roles.systemAdmin') : 'System Admin',\r\n    platform_manager: t ? t('roles.platformManager') : 'Platform Manager',\r\n    pin: t ? t('roles.pin.name') : 'PIN',\r\n    csr: t ? t('roles.csr.name') : 'CSR'\r\n  };\r\n  \r\n  return roleNames[userType] || userType;\r\n};\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}