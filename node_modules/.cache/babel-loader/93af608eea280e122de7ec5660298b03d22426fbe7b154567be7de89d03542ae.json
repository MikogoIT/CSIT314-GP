{"ast":null,"code":"// 真实数据报告服务\n// src/services/reportService.js\n\nimport { DataService } from './dataService';\nexport class ReportService {\n  // 获取指定日期范围的数据\n  static getDateRangeData(startDate, endDate, requests, users) {\n    const start = new Date(startDate);\n    const end = new Date(endDate);\n    const filteredRequests = requests.filter(request => {\n      const date = new Date(request.createdAt);\n      return date >= start && date <= end;\n    });\n    const filteredUsers = users.filter(user => {\n      const date = new Date(user.registeredAt || user.createdAt);\n      return date >= start && date <= end;\n    });\n    return {\n      requests: filteredRequests,\n      users: filteredUsers\n    };\n  }\n\n  // 生成日报数据\n  static async generateDailyReport(targetDate = new Date()) {\n    const users = await DataService.getUsers();\n    const requests = await DataService.getRequests();\n    const today = new Date(targetDate);\n    today.setHours(0, 0, 0, 0);\n    const tomorrow = new Date(today);\n    tomorrow.setDate(tomorrow.getDate() + 1);\n    const {\n      requests: todayRequests,\n      users: todayUsers\n    } = this.getDateRangeData(today.toISOString(), tomorrow.toISOString(), requests, users);\n\n    // 计算昨天的数据用于对比\n    const yesterday = new Date(today);\n    yesterday.setDate(yesterday.getDate() - 1);\n    const {\n      requests: yesterdayRequests,\n      users: yesterdayUsers\n    } = this.getDateRangeData(yesterday.toISOString(), today.toISOString(), requests, users);\n    const todayMatched = todayRequests.filter(r => r.status === 'matched').length;\n    const yesterdayMatched = yesterdayRequests.filter(r => r.status === 'matched').length;\n    const matchGrowth = yesterdayMatched === 0 ? todayMatched > 0 ? 100 : 0 : Math.round((todayMatched - yesterdayMatched) / yesterdayMatched * 100);\n    const userGrowth = yesterdayUsers.length === 0 ? todayUsers.length > 0 ? 100 : 0 : Math.round((todayUsers.length - yesterdayUsers.length) / yesterdayUsers.length * 100);\n    const activeRequests = requests.filter(r => r.status === 'pending' || r.status === 'matched').length;\n\n    // 计算完成率\n    const completedToday = todayRequests.filter(r => r.status === 'completed').length;\n    const totalProcessedToday = todayRequests.filter(r => r.status !== 'pending').length;\n    const completionRate = totalProcessedToday === 0 ? 0 : Math.round(completedToday / totalProcessedToday * 100);\n    return {\n      reportType: 'daily',\n      date: today.toISOString().split('T')[0],\n      totalMatches: todayMatched,\n      newUsers: todayUsers.length,\n      activeRequests: activeRequests,\n      completionRate: `${completionRate}%`,\n      trends: {\n        matchGrowth: matchGrowth,\n        userGrowth: userGrowth,\n        completionRateChange: 0\n      },\n      details: {\n        categoryBreakdown: await this.getCategoryBreakdown(todayRequests),\n        hourlyActivity: this.getHourlyActivity(todayRequests),\n        userTypeBreakdown: this.getUserTypeBreakdown(todayUsers)\n      }\n    };\n  }\n\n  // 生成周报数据\n  static async generateWeeklyReport(targetDate = new Date()) {\n    const users = await DataService.getUsers();\n    const requests = await DataService.getRequests();\n\n    // 计算包含目标日期的那一周（周一到周日）\n    const date = new Date(targetDate);\n    const dayOfWeek = date.getDay();\n    const startDate = new Date(date);\n    // 调整到周一（如果周日是0，则调整为-6，否则调整为1-dayOfWeek）\n    const daysToMonday = dayOfWeek === 0 ? -6 : 1 - dayOfWeek;\n    startDate.setDate(date.getDate() + daysToMonday);\n    startDate.setHours(0, 0, 0, 0);\n    const endDate = new Date(startDate);\n    endDate.setDate(startDate.getDate() + 6);\n    endDate.setHours(23, 59, 59, 999);\n    const {\n      requests: weekRequests,\n      users: weekUsers\n    } = this.getDateRangeData(startDate.toISOString(), endDate.toISOString(), requests, users);\n\n    // 计算上周数据用于对比\n    const lastWeekEnd = new Date(startDate);\n    const lastWeekStart = new Date(lastWeekEnd);\n    lastWeekStart.setDate(lastWeekStart.getDate() - 7);\n    const {\n      requests: lastWeekRequests,\n      users: lastWeekUsers\n    } = this.getDateRangeData(lastWeekStart.toISOString(), lastWeekEnd.toISOString(), requests, users);\n    const weekMatched = weekRequests.filter(r => r.status === 'matched').length;\n    const lastWeekMatched = lastWeekRequests.filter(r => r.status === 'matched').length;\n    const matchGrowth = lastWeekMatched === 0 ? weekMatched > 0 ? 100 : 0 : Math.round((weekMatched - lastWeekMatched) / lastWeekMatched * 100);\n    const userGrowth = lastWeekUsers.length === 0 ? weekUsers.length > 0 ? 100 : 0 : Math.round((weekUsers.length - lastWeekUsers.length) / lastWeekUsers.length * 100);\n    const activeRequests = requests.filter(r => r.status === 'pending' || r.status === 'matched').length;\n\n    // 计算完成率\n    const completedWeek = weekRequests.filter(r => r.status === 'completed').length;\n    const totalProcessedWeek = weekRequests.filter(r => r.status !== 'pending').length;\n    const completionRate = totalProcessedWeek === 0 ? 0 : Math.round(completedWeek / totalProcessedWeek * 100);\n    return {\n      reportType: 'weekly',\n      dateRange: `${startDate.toISOString().split('T')[0]} - ${endDate.toISOString().split('T')[0]}`,\n      totalMatches: weekMatched,\n      newUsers: weekUsers.length,\n      activeRequests: activeRequests,\n      completionRate: `${completionRate}%`,\n      trends: {\n        matchGrowth: matchGrowth,\n        userGrowth: userGrowth,\n        completionRateChange: 0\n      },\n      details: {\n        categoryBreakdown: await this.getCategoryBreakdown(weekRequests),\n        dailyActivity: this.getDailyActivity(weekRequests, startDate, endDate),\n        userTypeBreakdown: this.getUserTypeBreakdown(weekUsers)\n      }\n    };\n  }\n\n  // 生成月报数据\n  static async generateMonthlyReport(targetDate = new Date()) {\n    const users = await DataService.getUsers();\n    const requests = await DataService.getRequests();\n    const endDate = new Date(targetDate);\n    const startDate = new Date(endDate.getFullYear(), endDate.getMonth(), 1);\n    const {\n      requests: monthRequests,\n      users: monthUsers\n    } = this.getDateRangeData(startDate.toISOString(), endDate.toISOString(), requests, users);\n\n    // 计算上月数据用于对比\n    const lastMonthEnd = new Date(startDate);\n    lastMonthEnd.setDate(lastMonthEnd.getDate() - 1);\n    const lastMonthStart = new Date(lastMonthEnd.getFullYear(), lastMonthEnd.getMonth(), 1);\n    const {\n      requests: lastMonthRequests,\n      users: lastMonthUsers\n    } = this.getDateRangeData(lastMonthStart.toISOString(), lastMonthEnd.toISOString(), requests, users);\n    const monthMatched = monthRequests.filter(r => r.status === 'matched').length;\n    const lastMonthMatched = lastMonthRequests.filter(r => r.status === 'matched').length;\n    const matchGrowth = lastMonthMatched === 0 ? monthMatched > 0 ? 100 : 0 : Math.round((monthMatched - lastMonthMatched) / lastMonthMatched * 100);\n    const userGrowth = lastMonthUsers.length === 0 ? monthUsers.length > 0 ? 100 : 0 : Math.round((monthUsers.length - lastMonthUsers.length) / lastMonthUsers.length * 100);\n    const activeRequests = requests.filter(r => r.status === 'pending' || r.status === 'matched').length;\n\n    // 计算完成率\n    const completedMonth = monthRequests.filter(r => r.status === 'completed').length;\n    const totalProcessedMonth = monthRequests.filter(r => r.status !== 'pending').length;\n    const completionRate = totalProcessedMonth === 0 ? 0 : Math.round(completedMonth / totalProcessedMonth * 100);\n    return {\n      reportType: 'monthly',\n      dateRange: `${startDate.toISOString().split('T')[0]} - ${endDate.toISOString().split('T')[0]}`,\n      totalMatches: monthMatched,\n      newUsers: monthUsers.length,\n      activeRequests: activeRequests,\n      completionRate: `${completionRate}%`,\n      trends: {\n        matchGrowth: matchGrowth,\n        userGrowth: userGrowth,\n        completionRateChange: 0\n      },\n      details: {\n        categoryBreakdown: await this.getCategoryBreakdown(monthRequests),\n        weeklyActivity: this.getWeeklyActivity(monthRequests, startDate, endDate),\n        userTypeBreakdown: this.getUserTypeBreakdown(monthUsers),\n        topPerformers: this.getTopPerformers(monthRequests)\n      }\n    };\n  }\n\n  // 获取分类统计\n  static async getCategoryBreakdown(requests) {\n    const categories = await DataService.getCategories();\n    const breakdown = {};\n    categories.forEach(category => {\n      breakdown[category.id] = {\n        name: category.name,\n        count: requests.filter(r => r.category === category.id).length,\n        matched: requests.filter(r => r.category === category.id && r.status === 'matched').length\n      };\n    });\n    return breakdown;\n  }\n\n  // 获取用户类型统计\n  static getUserTypeBreakdown(users) {\n    return {\n      pin: users.filter(u => u.userType === 'pin').length,\n      csr: users.filter(u => u.userType === 'csr').length,\n      system_admin: users.filter(u => u.userType === 'system_admin').length,\n      platform_manager: users.filter(u => u.userType === 'platform_manager').length\n    };\n  }\n\n  // 获取每小时活动数据\n  static getHourlyActivity(requests) {\n    const hourlyData = Array.from({\n      length: 24\n    }, (_, i) => ({\n      hour: i,\n      count: 0\n    }));\n    requests.forEach(request => {\n      const hour = new Date(request.createdAt).getHours();\n      hourlyData[hour].count++;\n    });\n    return hourlyData;\n  }\n\n  // 获取每日活动数据\n  static getDailyActivity(requests, startDate, endDate) {\n    const dailyData = [];\n    const current = new Date(startDate);\n    while (current <= endDate) {\n      const dayStart = new Date(current);\n      dayStart.setHours(0, 0, 0, 0);\n      const dayEnd = new Date(current);\n      dayEnd.setHours(23, 59, 59, 999);\n      const dayRequests = requests.filter(request => {\n        const requestDate = new Date(request.createdAt);\n        return requestDate >= dayStart && requestDate <= dayEnd;\n      });\n      dailyData.push({\n        date: current.toISOString().split('T')[0],\n        count: dayRequests.length,\n        matched: dayRequests.filter(r => r.status === 'matched').length\n      });\n      current.setDate(current.getDate() + 1);\n    }\n    return dailyData;\n  }\n\n  // 获取每周活动数据  \n  static getWeeklyActivity(requests, startDate, endDate) {\n    const weeklyData = [];\n    const current = new Date(startDate);\n    while (current <= endDate) {\n      const weekStart = new Date(current);\n      const weekEnd = new Date(current);\n      weekEnd.setDate(weekEnd.getDate() + 6);\n      if (weekEnd > endDate) {\n        weekEnd.setTime(endDate.getTime());\n      }\n      const weekRequests = requests.filter(request => {\n        const requestDate = new Date(request.createdAt);\n        return requestDate >= weekStart && requestDate <= weekEnd;\n      });\n      weeklyData.push({\n        weekStart: weekStart.toISOString().split('T')[0],\n        weekEnd: weekEnd.toISOString().split('T')[0],\n        count: weekRequests.length,\n        matched: weekRequests.filter(r => r.status === 'matched').length\n      });\n      current.setDate(current.getDate() + 7);\n    }\n    return weeklyData;\n  }\n\n  // 获取优秀志愿者排行\n  static getTopPerformers(requests) {\n    const volunteerStats = {};\n    requests.filter(r => r.status === 'matched' && r.volunteer).forEach(request => {\n      const volunteer = request.volunteer;\n      if (!volunteerStats[volunteer]) {\n        volunteerStats[volunteer] = {\n          name: volunteer,\n          matches: 0,\n          categories: new Set()\n        };\n      }\n      volunteerStats[volunteer].matches++;\n      volunteerStats[volunteer].categories.add(request.category);\n    });\n    return Object.values(volunteerStats).map(v => ({\n      ...v,\n      categories: Array.from(v.categories)\n    })).sort((a, b) => b.matches - a.matches).slice(0, 5);\n  }\n\n  // 生成综合报告\n  static async generateComprehensiveReport(reportType = 'monthly', targetDate = new Date()) {\n    let report;\n    switch (reportType) {\n      case 'daily':\n        report = await this.generateDailyReport(targetDate);\n        break;\n      case 'weekly':\n        report = await this.generateWeeklyReport(targetDate);\n        break;\n      case 'monthly':\n        report = await this.generateMonthlyReport(targetDate);\n        break;\n      default:\n        report = await this.generateWeeklyReport(targetDate);\n    }\n    const allUsers = await DataService.getUsers();\n    const allRequests = await DataService.getRequests();\n    return {\n      ...report,\n      generatedAt: new Date().toISOString(),\n      systemInfo: {\n        totalUsers: allUsers.length,\n        totalRequests: allRequests.length,\n        systemHealth: 'good'\n      }\n    };\n  }\n\n  // 格式化报告为易读文本\n  static formatReportText(report) {\n    const reportTypeNames = {\n      daily: '日报',\n      weekly: '周报',\n      monthly: '月报'\n    };\n    let text = '';\n    text += '='.repeat(60) + '\\n';\n    text += `CSR志愿者匹配系统 - ${reportTypeNames[report.reportType] || '报告'}\\n`;\n    text += '='.repeat(60) + '\\n\\n';\n    text += `报告日期: ${report.date}\\n`;\n    text += `生成时间: ${new Date(report.generatedAt).toLocaleString('zh-CN')}\\n\\n`;\n    text += '-'.repeat(60) + '\\n';\n    text += '核心指标\\n';\n    text += '-'.repeat(60) + '\\n';\n    text += `总匹配数: ${report.totalMatches} 次\\n`;\n    text += `新增用户: ${report.newUsers} 人\\n`;\n    text += `活跃请求: ${report.activeRequests} 个\\n`;\n    text += `完成率: ${report.completionRate}\\n\\n`;\n    text += '-'.repeat(60) + '\\n';\n    text += '增长趋势\\n';\n    text += '-'.repeat(60) + '\\n';\n    text += `匹配增长率: ${report.trends.matchGrowth > 0 ? '+' : ''}${report.trends.matchGrowth}%\\n`;\n    text += `用户增长率: ${report.trends.userGrowth > 0 ? '+' : ''}${report.trends.userGrowth}%\\n\\n`;\n    if (report.details.categoryBreakdown) {\n      text += '-'.repeat(60) + '\\n';\n      text += '分类统计\\n';\n      text += '-'.repeat(60) + '\\n';\n      Object.entries(report.details.categoryBreakdown).forEach(([key, data]) => {\n        text += `${data.name}: ${data.count} 个请求 (匹配: ${data.matched})\\n`;\n      });\n      text += '\\n';\n    }\n    if (report.details.userTypeBreakdown) {\n      text += '-'.repeat(60) + '\\n';\n      text += '用户类型分布\\n';\n      text += '-'.repeat(60) + '\\n';\n      text += `PIN用户 (需要帮助): ${report.details.userTypeBreakdown.pin} 人\\n`;\n      text += `CSR志愿者: ${report.details.userTypeBreakdown.csr} 人\\n`;\n      text += `管理员: ${report.details.userTypeBreakdown.admin} 人\\n\\n`;\n    }\n    if (report.details.topPerformers && report.details.topPerformers.length > 0) {\n      text += '-'.repeat(60) + '\\n';\n      text += '优秀志愿者 (Top 5)\\n';\n      text += '-'.repeat(60) + '\\n';\n      report.details.topPerformers.forEach((volunteer, index) => {\n        text += `${index + 1}. ${volunteer.name}\\n`;\n        text += `   完成匹配: ${volunteer.matches} 次\\n`;\n        text += `   平均评分: ${volunteer.averageRating.toFixed(1)} 分\\n`;\n        text += `   服务类别: ${Array.from(volunteer.categories).join(', ')}\\n\\n`;\n      });\n    }\n    text += '-'.repeat(60) + '\\n';\n    text += '系统信息\\n';\n    text += '-'.repeat(60) + '\\n';\n    text += `总用户数: ${report.systemInfo.totalUsers} 人\\n`;\n    text += `总请求数: ${report.systemInfo.totalRequests} 个\\n`;\n    text += `系统状态: ${report.systemInfo.systemHealth === 'good' ? '良好' : '异常'}\\n\\n`;\n    text += '='.repeat(60) + '\\n';\n    text += '报告结束\\n';\n    text += '='.repeat(60) + '\\n';\n    return text;\n  }\n\n  // 导出报告为易读文本文件\n  static exportReport(report, filename) {\n    const textContent = this.formatReportText(report);\n    const textBlob = new Blob([textContent], {\n      type: 'text/plain;charset=utf-8;'\n    });\n    const link = document.createElement('a');\n    link.href = URL.createObjectURL(textBlob);\n    link.download = `${filename}_${report.reportType}_${report.date}.txt`;\n    document.body.appendChild(link);\n    link.click();\n    document.body.removeChild(link);\n  }\n\n  // 导出报告为JSON（原始数据）\n  static exportReportJSON(report, filename) {\n    const dataStr = JSON.stringify(report, null, 2);\n    const dataBlob = new Blob([dataStr], {\n      type: 'application/json'\n    });\n    const link = document.createElement('a');\n    link.href = URL.createObjectURL(dataBlob);\n    link.download = `${filename}_${report.reportType}_${report.date}.json`;\n    document.body.appendChild(link);\n    link.click();\n    document.body.removeChild(link);\n  }\n\n  // 导出报告为CSV（简化版）\n  static exportReportCSV(report, filename) {\n    const csvData = [['指标', '数值', '增长率'], ['总匹配数', report.totalMatches, `${report.trends.matchGrowth}%`], ['新用户', report.newUsers, `${report.trends.userGrowth}%`], ['活跃请求', report.activeRequests, ''], ['完成率', report.completionRate, '']];\n    const csvContent = csvData.map(row => row.join(',')).join('\\n');\n    const csvBlob = new Blob([csvContent], {\n      type: 'text/csv;charset=utf-8;'\n    });\n    const link = document.createElement('a');\n    link.href = URL.createObjectURL(csvBlob);\n    link.download = `${filename}_${report.reportType}_${new Date().toISOString().split('T')[0]}.csv`;\n    document.body.appendChild(link);\n    link.click();\n    document.body.removeChild(link);\n  }\n\n  // 生成并下载综合报告\n  static async generateAndDownloadReport(reportType = 'monthly', targetDate = new Date()) {\n    const report = await this.generateComprehensiveReport(reportType, targetDate);\n    this.exportReport(report, 'system_report');\n    return report;\n  }\n}","map":{"version":3,"names":["DataService","ReportService","getDateRangeData","startDate","endDate","requests","users","start","Date","end","filteredRequests","filter","request","date","createdAt","filteredUsers","user","registeredAt","generateDailyReport","targetDate","getUsers","getRequests","today","setHours","tomorrow","setDate","getDate","todayRequests","todayUsers","toISOString","yesterday","yesterdayRequests","yesterdayUsers","todayMatched","r","status","length","yesterdayMatched","matchGrowth","Math","round","userGrowth","activeRequests","completedToday","totalProcessedToday","completionRate","reportType","split","totalMatches","newUsers","trends","completionRateChange","details","categoryBreakdown","getCategoryBreakdown","hourlyActivity","getHourlyActivity","userTypeBreakdown","getUserTypeBreakdown","generateWeeklyReport","dayOfWeek","getDay","daysToMonday","weekRequests","weekUsers","lastWeekEnd","lastWeekStart","lastWeekRequests","lastWeekUsers","weekMatched","lastWeekMatched","completedWeek","totalProcessedWeek","dateRange","dailyActivity","getDailyActivity","generateMonthlyReport","getFullYear","getMonth","monthRequests","monthUsers","lastMonthEnd","lastMonthStart","lastMonthRequests","lastMonthUsers","monthMatched","lastMonthMatched","completedMonth","totalProcessedMonth","weeklyActivity","getWeeklyActivity","topPerformers","getTopPerformers","categories","getCategories","breakdown","forEach","category","id","name","count","matched","pin","u","userType","csr","system_admin","platform_manager","hourlyData","Array","from","_","i","hour","getHours","dailyData","current","dayStart","dayEnd","dayRequests","requestDate","push","weeklyData","weekStart","weekEnd","setTime","getTime","volunteerStats","volunteer","matches","Set","add","Object","values","map","v","sort","a","b","slice","generateComprehensiveReport","report","allUsers","allRequests","generatedAt","systemInfo","totalUsers","totalRequests","systemHealth","formatReportText","reportTypeNames","daily","weekly","monthly","text","repeat","toLocaleString","entries","key","data","admin","index","averageRating","toFixed","join","exportReport","filename","textContent","textBlob","Blob","type","link","document","createElement","href","URL","createObjectURL","download","body","appendChild","click","removeChild","exportReportJSON","dataStr","JSON","stringify","dataBlob","exportReportCSV","csvData","csvContent","row","csvBlob","generateAndDownloadReport"],"sources":["D:/Study/CSIT314-GP/src/services/reportService.js"],"sourcesContent":["// 真实数据报告服务\n// src/services/reportService.js\n\nimport { DataService } from './dataService';\n\nexport class ReportService {\n  // 获取指定日期范围的数据\n  static getDateRangeData(startDate, endDate, requests, users) {\n    const start = new Date(startDate);\n    const end = new Date(endDate);\n    \n    const filteredRequests = requests.filter(request => {\n      const date = new Date(request.createdAt);\n      return date >= start && date <= end;\n    });\n    \n    const filteredUsers = users.filter(user => {\n      const date = new Date(user.registeredAt || user.createdAt);\n      return date >= start && date <= end;\n    });\n    \n    return { requests: filteredRequests, users: filteredUsers };\n  }\n  \n  // 生成日报数据\n  static async generateDailyReport(targetDate = new Date()) {\n    const users = await DataService.getUsers();\n    const requests = await DataService.getRequests();\n    \n    const today = new Date(targetDate);\n    today.setHours(0, 0, 0, 0);\n    const tomorrow = new Date(today);\n    tomorrow.setDate(tomorrow.getDate() + 1);\n    \n    const { requests: todayRequests, users: todayUsers } = this.getDateRangeData(\n      today.toISOString(),\n      tomorrow.toISOString(),\n      requests,\n      users\n    );\n    \n    // 计算昨天的数据用于对比\n    const yesterday = new Date(today);\n    yesterday.setDate(yesterday.getDate() - 1);\n    const { requests: yesterdayRequests, users: yesterdayUsers } = this.getDateRangeData(\n      yesterday.toISOString(),\n      today.toISOString(),\n      requests,\n      users\n    );\n    \n    const todayMatched = todayRequests.filter(r => r.status === 'matched').length;\n    const yesterdayMatched = yesterdayRequests.filter(r => r.status === 'matched').length;\n    \n    const matchGrowth = yesterdayMatched === 0 ? (todayMatched > 0 ? 100 : 0) : \n      Math.round(((todayMatched - yesterdayMatched) / yesterdayMatched) * 100);\n    \n    const userGrowth = yesterdayUsers.length === 0 ? (todayUsers.length > 0 ? 100 : 0) :\n      Math.round(((todayUsers.length - yesterdayUsers.length) / yesterdayUsers.length) * 100);\n    \n    const activeRequests = requests.filter(r => r.status === 'pending' || r.status === 'matched').length;\n    \n    // 计算完成率\n    const completedToday = todayRequests.filter(r => r.status === 'completed').length;\n    const totalProcessedToday = todayRequests.filter(r => r.status !== 'pending').length;\n    const completionRate = totalProcessedToday === 0 ? 0 : \n      Math.round((completedToday / totalProcessedToday) * 100);\n    \n    return {\n      reportType: 'daily',\n      date: today.toISOString().split('T')[0],\n      totalMatches: todayMatched,\n      newUsers: todayUsers.length,\n      activeRequests: activeRequests,\n      completionRate: `${completionRate}%`,\n      trends: {\n        matchGrowth: matchGrowth,\n        userGrowth: userGrowth,\n        completionRateChange: 0\n      },\n      details: {\n        categoryBreakdown: await this.getCategoryBreakdown(todayRequests),\n        hourlyActivity: this.getHourlyActivity(todayRequests),\n        userTypeBreakdown: this.getUserTypeBreakdown(todayUsers)\n      }\n    };\n  }\n  \n  // 生成周报数据\n  static async generateWeeklyReport(targetDate = new Date()) {\n    const users = await DataService.getUsers();\n    const requests = await DataService.getRequests();\n    \n    // 计算包含目标日期的那一周（周一到周日）\n    const date = new Date(targetDate);\n    const dayOfWeek = date.getDay();\n    const startDate = new Date(date);\n    // 调整到周一（如果周日是0，则调整为-6，否则调整为1-dayOfWeek）\n    const daysToMonday = dayOfWeek === 0 ? -6 : 1 - dayOfWeek;\n    startDate.setDate(date.getDate() + daysToMonday);\n    startDate.setHours(0, 0, 0, 0);\n    \n    const endDate = new Date(startDate);\n    endDate.setDate(startDate.getDate() + 6);\n    endDate.setHours(23, 59, 59, 999);\n    \n    const { requests: weekRequests, users: weekUsers } = this.getDateRangeData(\n      startDate.toISOString(),\n      endDate.toISOString(),\n      requests,\n      users\n    );\n    \n    // 计算上周数据用于对比\n    const lastWeekEnd = new Date(startDate);\n    const lastWeekStart = new Date(lastWeekEnd);\n    lastWeekStart.setDate(lastWeekStart.getDate() - 7);\n    \n    const { requests: lastWeekRequests, users: lastWeekUsers } = this.getDateRangeData(\n      lastWeekStart.toISOString(),\n      lastWeekEnd.toISOString(),\n      requests,\n      users\n    );\n    \n    const weekMatched = weekRequests.filter(r => r.status === 'matched').length;\n    const lastWeekMatched = lastWeekRequests.filter(r => r.status === 'matched').length;\n    \n    const matchGrowth = lastWeekMatched === 0 ? (weekMatched > 0 ? 100 : 0) : \n      Math.round(((weekMatched - lastWeekMatched) / lastWeekMatched) * 100);\n    \n    const userGrowth = lastWeekUsers.length === 0 ? (weekUsers.length > 0 ? 100 : 0) :\n      Math.round(((weekUsers.length - lastWeekUsers.length) / lastWeekUsers.length) * 100);\n    \n    const activeRequests = requests.filter(r => r.status === 'pending' || r.status === 'matched').length;\n    \n    // 计算完成率\n    const completedWeek = weekRequests.filter(r => r.status === 'completed').length;\n    const totalProcessedWeek = weekRequests.filter(r => r.status !== 'pending').length;\n    const completionRate = totalProcessedWeek === 0 ? 0 : \n      Math.round((completedWeek / totalProcessedWeek) * 100);\n    \n    return {\n      reportType: 'weekly',\n      dateRange: `${startDate.toISOString().split('T')[0]} - ${endDate.toISOString().split('T')[0]}`,\n      totalMatches: weekMatched,\n      newUsers: weekUsers.length,\n      activeRequests: activeRequests,\n      completionRate: `${completionRate}%`,\n      trends: {\n        matchGrowth: matchGrowth,\n        userGrowth: userGrowth,\n        completionRateChange: 0\n      },\n      details: {\n        categoryBreakdown: await this.getCategoryBreakdown(weekRequests),\n        dailyActivity: this.getDailyActivity(weekRequests, startDate, endDate),\n        userTypeBreakdown: this.getUserTypeBreakdown(weekUsers)\n      }\n    };\n  }\n  \n  // 生成月报数据\n  static async generateMonthlyReport(targetDate = new Date()) {\n    const users = await DataService.getUsers();\n    const requests = await DataService.getRequests();\n    \n    const endDate = new Date(targetDate);\n    const startDate = new Date(endDate.getFullYear(), endDate.getMonth(), 1);\n    \n    const { requests: monthRequests, users: monthUsers } = this.getDateRangeData(\n      startDate.toISOString(),\n      endDate.toISOString(),\n      requests,\n      users\n    );\n    \n    // 计算上月数据用于对比\n    const lastMonthEnd = new Date(startDate);\n    lastMonthEnd.setDate(lastMonthEnd.getDate() - 1);\n    const lastMonthStart = new Date(lastMonthEnd.getFullYear(), lastMonthEnd.getMonth(), 1);\n    \n    const { requests: lastMonthRequests, users: lastMonthUsers } = this.getDateRangeData(\n      lastMonthStart.toISOString(),\n      lastMonthEnd.toISOString(),\n      requests,\n      users\n    );\n    \n    const monthMatched = monthRequests.filter(r => r.status === 'matched').length;\n    const lastMonthMatched = lastMonthRequests.filter(r => r.status === 'matched').length;\n    \n    const matchGrowth = lastMonthMatched === 0 ? (monthMatched > 0 ? 100 : 0) : \n      Math.round(((monthMatched - lastMonthMatched) / lastMonthMatched) * 100);\n    \n    const userGrowth = lastMonthUsers.length === 0 ? (monthUsers.length > 0 ? 100 : 0) :\n      Math.round(((monthUsers.length - lastMonthUsers.length) / lastMonthUsers.length) * 100);\n    \n    const activeRequests = requests.filter(r => r.status === 'pending' || r.status === 'matched').length;\n    \n    // 计算完成率\n    const completedMonth = monthRequests.filter(r => r.status === 'completed').length;\n    const totalProcessedMonth = monthRequests.filter(r => r.status !== 'pending').length;\n    const completionRate = totalProcessedMonth === 0 ? 0 : \n      Math.round((completedMonth / totalProcessedMonth) * 100);\n    \n    return {\n      reportType: 'monthly',\n      dateRange: `${startDate.toISOString().split('T')[0]} - ${endDate.toISOString().split('T')[0]}`,\n      totalMatches: monthMatched,\n      newUsers: monthUsers.length,\n      activeRequests: activeRequests,\n      completionRate: `${completionRate}%`,\n      trends: {\n        matchGrowth: matchGrowth,\n        userGrowth: userGrowth,\n        completionRateChange: 0\n      },\n      details: {\n        categoryBreakdown: await this.getCategoryBreakdown(monthRequests),\n        weeklyActivity: this.getWeeklyActivity(monthRequests, startDate, endDate),\n        userTypeBreakdown: this.getUserTypeBreakdown(monthUsers),\n        topPerformers: this.getTopPerformers(monthRequests)\n      }\n    };\n  }\n  \n  // 获取分类统计\n  static async getCategoryBreakdown(requests) {\n    const categories = await DataService.getCategories();\n    const breakdown = {};\n    \n    categories.forEach(category => {\n      breakdown[category.id] = {\n        name: category.name,\n        count: requests.filter(r => r.category === category.id).length,\n        matched: requests.filter(r => r.category === category.id && r.status === 'matched').length\n      };\n    });\n    \n    return breakdown;\n  }\n  \n  // 获取用户类型统计\n  static getUserTypeBreakdown(users) {\n    return {\n      pin: users.filter(u => u.userType === 'pin').length,\n      csr: users.filter(u => u.userType === 'csr').length,\n      system_admin: users.filter(u => u.userType === 'system_admin').length,\n      platform_manager: users.filter(u => u.userType === 'platform_manager').length\n    };\n  }\n  \n  // 获取每小时活动数据\n  static getHourlyActivity(requests) {\n    const hourlyData = Array.from({ length: 24 }, (_, i) => ({ hour: i, count: 0 }));\n    \n    requests.forEach(request => {\n      const hour = new Date(request.createdAt).getHours();\n      hourlyData[hour].count++;\n    });\n    \n    return hourlyData;\n  }\n  \n  // 获取每日活动数据\n  static getDailyActivity(requests, startDate, endDate) {\n    const dailyData = [];\n    const current = new Date(startDate);\n    \n    while (current <= endDate) {\n      const dayStart = new Date(current);\n      dayStart.setHours(0, 0, 0, 0);\n      const dayEnd = new Date(current);\n      dayEnd.setHours(23, 59, 59, 999);\n      \n      const dayRequests = requests.filter(request => {\n        const requestDate = new Date(request.createdAt);\n        return requestDate >= dayStart && requestDate <= dayEnd;\n      });\n      \n      dailyData.push({\n        date: current.toISOString().split('T')[0],\n        count: dayRequests.length,\n        matched: dayRequests.filter(r => r.status === 'matched').length\n      });\n      \n      current.setDate(current.getDate() + 1);\n    }\n    \n    return dailyData;\n  }\n  \n  // 获取每周活动数据  \n  static getWeeklyActivity(requests, startDate, endDate) {\n    const weeklyData = [];\n    const current = new Date(startDate);\n    \n    while (current <= endDate) {\n      const weekStart = new Date(current);\n      const weekEnd = new Date(current);\n      weekEnd.setDate(weekEnd.getDate() + 6);\n      \n      if (weekEnd > endDate) {\n        weekEnd.setTime(endDate.getTime());\n      }\n      \n      const weekRequests = requests.filter(request => {\n        const requestDate = new Date(request.createdAt);\n        return requestDate >= weekStart && requestDate <= weekEnd;\n      });\n      \n      weeklyData.push({\n        weekStart: weekStart.toISOString().split('T')[0],\n        weekEnd: weekEnd.toISOString().split('T')[0],\n        count: weekRequests.length,\n        matched: weekRequests.filter(r => r.status === 'matched').length\n      });\n      \n      current.setDate(current.getDate() + 7);\n    }\n    \n    return weeklyData;\n  }\n  \n  // 获取优秀志愿者排行\n  static getTopPerformers(requests) {\n    const volunteerStats = {};\n    \n    requests.filter(r => r.status === 'matched' && r.volunteer).forEach(request => {\n      const volunteer = request.volunteer;\n      if (!volunteerStats[volunteer]) {\n        volunteerStats[volunteer] = {\n          name: volunteer,\n          matches: 0,\n          categories: new Set()\n        };\n      }\n      volunteerStats[volunteer].matches++;\n      volunteerStats[volunteer].categories.add(request.category);\n    });\n    \n    return Object.values(volunteerStats)\n      .map(v => ({\n        ...v,\n        categories: Array.from(v.categories)\n      }))\n      .sort((a, b) => b.matches - a.matches)\n      .slice(0, 5);\n  }\n  \n  // 生成综合报告\n  static async generateComprehensiveReport(reportType = 'monthly', targetDate = new Date()) {\n    let report;\n    \n    switch (reportType) {\n      case 'daily':\n        report = await this.generateDailyReport(targetDate);\n        break;\n      case 'weekly':\n        report = await this.generateWeeklyReport(targetDate);\n        break;\n      case 'monthly':\n        report = await this.generateMonthlyReport(targetDate);\n        break;\n      default:\n        report = await this.generateWeeklyReport(targetDate);\n    }\n    \n    const allUsers = await DataService.getUsers();\n    const allRequests = await DataService.getRequests();\n    \n    return {\n      ...report,\n      generatedAt: new Date().toISOString(),\n      systemInfo: {\n        totalUsers: allUsers.length,\n        totalRequests: allRequests.length,\n        systemHealth: 'good'\n      }\n    };\n  }\n  \n  // 格式化报告为易读文本\n  static formatReportText(report) {\n    const reportTypeNames = {\n      daily: '日报',\n      weekly: '周报',\n      monthly: '月报'\n    };\n    \n    let text = '';\n    text += '='.repeat(60) + '\\n';\n    text += `CSR志愿者匹配系统 - ${reportTypeNames[report.reportType] || '报告'}\\n`;\n    text += '='.repeat(60) + '\\n\\n';\n    \n    text += `报告日期: ${report.date}\\n`;\n    text += `生成时间: ${new Date(report.generatedAt).toLocaleString('zh-CN')}\\n\\n`;\n    \n    text += '-'.repeat(60) + '\\n';\n    text += '核心指标\\n';\n    text += '-'.repeat(60) + '\\n';\n    text += `总匹配数: ${report.totalMatches} 次\\n`;\n    text += `新增用户: ${report.newUsers} 人\\n`;\n    text += `活跃请求: ${report.activeRequests} 个\\n`;\n    text += `完成率: ${report.completionRate}\\n\\n`;\n    \n    text += '-'.repeat(60) + '\\n';\n    text += '增长趋势\\n';\n    text += '-'.repeat(60) + '\\n';\n    text += `匹配增长率: ${report.trends.matchGrowth > 0 ? '+' : ''}${report.trends.matchGrowth}%\\n`;\n    text += `用户增长率: ${report.trends.userGrowth > 0 ? '+' : ''}${report.trends.userGrowth}%\\n\\n`;\n    \n    if (report.details.categoryBreakdown) {\n      text += '-'.repeat(60) + '\\n';\n      text += '分类统计\\n';\n      text += '-'.repeat(60) + '\\n';\n      Object.entries(report.details.categoryBreakdown).forEach(([key, data]) => {\n        text += `${data.name}: ${data.count} 个请求 (匹配: ${data.matched})\\n`;\n      });\n      text += '\\n';\n    }\n    \n    if (report.details.userTypeBreakdown) {\n      text += '-'.repeat(60) + '\\n';\n      text += '用户类型分布\\n';\n      text += '-'.repeat(60) + '\\n';\n      text += `PIN用户 (需要帮助): ${report.details.userTypeBreakdown.pin} 人\\n`;\n      text += `CSR志愿者: ${report.details.userTypeBreakdown.csr} 人\\n`;\n      text += `管理员: ${report.details.userTypeBreakdown.admin} 人\\n\\n`;\n    }\n    \n    if (report.details.topPerformers && report.details.topPerformers.length > 0) {\n      text += '-'.repeat(60) + '\\n';\n      text += '优秀志愿者 (Top 5)\\n';\n      text += '-'.repeat(60) + '\\n';\n      report.details.topPerformers.forEach((volunteer, index) => {\n        text += `${index + 1}. ${volunteer.name}\\n`;\n        text += `   完成匹配: ${volunteer.matches} 次\\n`;\n        text += `   平均评分: ${volunteer.averageRating.toFixed(1)} 分\\n`;\n        text += `   服务类别: ${Array.from(volunteer.categories).join(', ')}\\n\\n`;\n      });\n    }\n    \n    text += '-'.repeat(60) + '\\n';\n    text += '系统信息\\n';\n    text += '-'.repeat(60) + '\\n';\n    text += `总用户数: ${report.systemInfo.totalUsers} 人\\n`;\n    text += `总请求数: ${report.systemInfo.totalRequests} 个\\n`;\n    text += `系统状态: ${report.systemInfo.systemHealth === 'good' ? '良好' : '异常'}\\n\\n`;\n    \n    text += '='.repeat(60) + '\\n';\n    text += '报告结束\\n';\n    text += '='.repeat(60) + '\\n';\n    \n    return text;\n  }\n  \n  // 导出报告为易读文本文件\n  static exportReport(report, filename) {\n    const textContent = this.formatReportText(report);\n    const textBlob = new Blob([textContent], { type: 'text/plain;charset=utf-8;' });\n    \n    const link = document.createElement('a');\n    link.href = URL.createObjectURL(textBlob);\n    link.download = `${filename}_${report.reportType}_${report.date}.txt`;\n    document.body.appendChild(link);\n    link.click();\n    document.body.removeChild(link);\n  }\n  \n  // 导出报告为JSON（原始数据）\n  static exportReportJSON(report, filename) {\n    const dataStr = JSON.stringify(report, null, 2);\n    const dataBlob = new Blob([dataStr], { type: 'application/json' });\n    \n    const link = document.createElement('a');\n    link.href = URL.createObjectURL(dataBlob);\n    link.download = `${filename}_${report.reportType}_${report.date}.json`;\n    document.body.appendChild(link);\n    link.click();\n    document.body.removeChild(link);\n  }\n  \n  // 导出报告为CSV（简化版）\n  static exportReportCSV(report, filename) {\n    const csvData = [\n      ['指标', '数值', '增长率'],\n      ['总匹配数', report.totalMatches, `${report.trends.matchGrowth}%`],\n      ['新用户', report.newUsers, `${report.trends.userGrowth}%`],\n      ['活跃请求', report.activeRequests, ''],\n      ['完成率', report.completionRate, '']\n    ];\n    \n    const csvContent = csvData.map(row => row.join(',')).join('\\n');\n    const csvBlob = new Blob([csvContent], { type: 'text/csv;charset=utf-8;' });\n    \n    const link = document.createElement('a');\n    link.href = URL.createObjectURL(csvBlob);\n    link.download = `${filename}_${report.reportType}_${new Date().toISOString().split('T')[0]}.csv`;\n    document.body.appendChild(link);\n    link.click();\n    document.body.removeChild(link);\n  }\n  \n  // 生成并下载综合报告\n  static async generateAndDownloadReport(reportType = 'monthly', targetDate = new Date()) {\n    const report = await this.generateComprehensiveReport(reportType, targetDate);\n    this.exportReport(report, 'system_report');\n    return report;\n  }\n}"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}